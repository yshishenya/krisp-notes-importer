/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Kt=Object.create;var ht=Object.defineProperty;var Ut=Object.getOwnPropertyDescriptor;var Gt=Object.getOwnPropertyNames;var Ht=Object.getPrototypeOf,jt=Object.prototype.hasOwnProperty;var Yt=(d,t)=>()=>(t||d((t={exports:{}}).exports,t),t.exports),Vt=(d,t)=>{for(var e in t)ht(d,e,{get:t[e],enumerable:!0})},zt=(d,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Gt(t))!jt.call(d,i)&&i!==e&&ht(d,i,{get:()=>t[i],enumerable:!(s=Ut(t,i))||s.enumerable});return d};var st=(d,t,e)=>(e=d!=null?Kt(Ht(d)):{},zt(t||!d||!d.__esModule?ht(e,"default",{value:d,enumerable:!0}):e,d)),qt=d=>zt(ht({},"__esModule",{value:!0}),d);var Zt=Yt((Ee,Bt)=>{var B=require("fs"),Qt=require("util"),rt=require("path"),Ct=require("events"),Rt=require("zlib"),Ot=require("stream"),g={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSIGFIRST:80,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,MAXFILECOMMENT:65535,ENDL64HDR:20,ENDL64SIG:117853008,ENDL64SIGFIRST:80,ENDL64OFS:8,END64HDR:56,END64SIG:101075792,END64SIGFIRST:80,END64SUB:24,END64TOT:32,END64SIZ:40,END64OFF:48,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,FLG_ENC:0,FLG_COMP1:1,FLG_COMP2:2,FLG_DESC:4,FLG_ENH:8,FLG_STR:16,FLG_LNG:1024,FLG_MSK:4096,FLG_ENTRY_ENC:1,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535},Q=function(d){let t,e,s,i,n,r,l=this,a=d.storeEntries!==!1?{}:null,c=d.file,f=d.nameEncoding?new TextDecoder(d.nameEncoding):null;w();function w(){d.fd?(t=d.fd,v()):B.open(c,"r",(o,h)=>{if(o)return l.emit("error",o);t=h,v()})}function v(){B.fstat(t,(o,h)=>{if(o)return l.emit("error",o);e=h.size,s=d.chunkSize||Math.round(e/1e3),s=Math.max(Math.min(s,Math.min(128*1024,e)),Math.min(1024,e)),E()})}function S(o,h){if(o||!h)return l.emit("error",o||new Error("Archive read error"));let m=i.lastPos,u=m-i.win.position,P=i.win.buffer,N=i.minPos;for(;--m>=N&&--u>=0;)if(P.length-u>=4&&P[u]===i.firstByte&&P.readUInt32LE(u)===i.sig){i.lastBufferPosition=u,i.lastBytesRead=h,i.complete();return}if(m===N)return l.emit("error",new Error("Bad archive"));if(i.lastPos=m+1,i.chunkSize*=2,m<=N)return l.emit("error",new Error("Bad archive"));let T=Math.min(i.chunkSize,m-N);i.win.expandLeft(T,S)}function E(){let o=Math.min(g.ENDHDR+g.MAXFILECOMMENT,e);i={win:new dt(t),totalReadLength:o,minPos:e-o,lastPos:e,chunkSize:Math.min(1024,s),firstByte:g.ENDSIGFIRST,sig:g.ENDSIG,complete:y},i.win.read(e-i.chunkSize,i.chunkSize,S)}function y(){let o=i.win.buffer,h=i.lastBufferPosition;try{n=new Nt,n.read(o.slice(h,h+g.ENDHDR)),n.headerOffset=i.win.position+h,n.commentLength?l.comment=o.slice(h+g.ENDHDR,h+g.ENDHDR+n.commentLength).toString():l.comment=null,l.entriesCount=n.volumeEntries,l.centralDirectory=n,n.volumeEntries===g.EF_ZIP64_OR_16&&n.totalEntries===g.EF_ZIP64_OR_16||n.size===g.EF_ZIP64_OR_32||n.offset===g.EF_ZIP64_OR_32?L():(i={},b())}catch(m){l.emit("error",m)}}function L(){let o=g.ENDL64HDR;i.lastBufferPosition>o?(i.lastBufferPosition-=o,x()):(i={win:i.win,totalReadLength:o,minPos:i.win.position-o,lastPos:i.win.position,chunkSize:i.chunkSize,firstByte:g.ENDL64SIGFIRST,sig:g.ENDL64SIG,complete:x},i.win.read(i.lastPos-i.chunkSize,i.chunkSize,S))}function x(){let o=i.win.buffer,h=new Pt;h.read(o.slice(i.lastBufferPosition,i.lastBufferPosition+g.ENDL64HDR));let m=e-h.headerOffset;i={win:i.win,totalReadLength:m,minPos:h.headerOffset,lastPos:i.lastPos,chunkSize:i.chunkSize,firstByte:g.END64SIGFIRST,sig:g.END64SIG,complete:F},i.win.read(e-i.chunkSize,i.chunkSize,S)}function F(){let o=i.win.buffer,h=new bt;h.read(o.slice(i.lastBufferPosition,i.lastBufferPosition+g.END64HDR)),l.centralDirectory.volumeEntries=h.volumeEntries,l.centralDirectory.totalEntries=h.totalEntries,l.centralDirectory.size=h.size,l.centralDirectory.offset=h.offset,l.entriesCount=h.volumeEntries,i={},b()}function b(){i={win:new dt(t),pos:n.offset,chunkSize:s,entriesLeft:n.volumeEntries},i.win.read(i.pos,Math.min(s,e-i.pos),M)}function M(o,h){if(o||!h)return l.emit("error",o||new Error("Entries read error"));let m=i.pos-i.win.position,u=i.entry,P=i.win.buffer,N=P.length;try{for(;i.entriesLeft>0;){u||(u=new xt,u.readHeader(P,m),u.headerOffset=i.win.position+m,i.entry=u,i.pos+=g.CENHDR,m+=g.CENHDR);let T=u.fnameLen+u.extraLen+u.comLen,C=T+(i.entriesLeft>1?g.CENHDR:0);if(N-m<C){i.win.moveRight(s,M,m),i.move=!0;return}u.read(P,m,f),d.skipEntryNameValidation||u.validateName(),a&&(a[u.name]=u),l.emit("entry",u),i.entry=u=null,i.entriesLeft--,i.pos+=T,m+=T}l.emit("ready")}catch(T){l.emit("error",T)}}function A(){if(!a)throw new Error("storeEntries disabled")}Object.defineProperty(this,"ready",{get(){return!1}}),this.entry=function(o){return A(),a[o]},this.entries=function(){return A(),a},this.stream=function(o,h){return this.openEntry(o,(m,u)=>{if(m)return h(m);let P=z(u),N=new Tt(t,P,u.compressedSize);if(u.method!==g.STORED)if(u.method===g.DEFLATED)N=N.pipe(Rt.createInflateRaw());else return h(new Error("Unknown compression method: "+u.method));U(u)&&(N=N.pipe(new Dt(N,u.crc,u.size))),h(null,N)},!1)},this.entryDataSync=function(o){let h=null;if(this.openEntry(o,(u,P)=>{h=u,o=P},!0),h)throw h;let m=Buffer.alloc(o.compressedSize);if(new q(t,m,0,o.compressedSize,z(o),u=>{h=u}).read(!0),h)throw h;if(o.method!==g.STORED)if(o.method===g.DEFLATED||o.method===g.ENHANCED_DEFLATED)m=Rt.inflateRawSync(m);else throw new Error("Unknown compression method: "+o.method);if(m.length!==o.size)throw new Error("Invalid size");return U(o)&&new J(o.crc,o.size).data(m),m},this.openEntry=function(o,h,m){if(typeof o=="string"&&(A(),o=a[o],!o))return h(new Error("Entry not found"));if(!o.isFile)return h(new Error("Entry is not file"));if(!t)return h(new Error("Archive closed"));let u=Buffer.alloc(g.LOCHDR);new q(t,u,0,u.length,o.offset,P=>{if(P)return h(P);let N;try{o.readDataHeader(u),o.encrypted&&(N=new Error("Entry encrypted"))}catch(T){N=T}h(N,o)}).read(m)};function z(o){return o.offset+g.LOCHDR+o.fnameLen+o.extraLen}function U(o){return(o.flags&8)!==8}function k(o,h,m){l.stream(o,(u,P)=>{if(u)m(u);else{let N,T;P.on("error",C=>{T=C,N&&(P.unpipe(N),N.close(()=>{m(C)}))}),B.open(h,"w",(C,_)=>{if(C)return m(C);if(T){B.close(t,()=>{m(T)});return}N=B.createWriteStream(h,{fd:_}),N.on("finish",()=>{l.emit("extract",o,h),T||m()}),P.pipe(N)})}})}function D(o,h,m){if(!h.length)return m();let u=h.shift();u=rt.join(o,rt.join(...u)),B.mkdir(u,{recursive:!0},P=>{if(P&&P.code!=="EEXIST")return m(P);D(o,h,m)})}function it(o,h,m,u,P){if(!m.length)return u(null,P);let N=m.shift(),T=rt.join(o,N.name.replace(h,""));k(N,T,C=>{if(C)return u(C,P);it(o,h,m,u,P+1)})}this.extract=function(o,h,m){let u=o||"";if(typeof o=="string"&&(o=this.entry(o),o?u=o.name:u.length&&u[u.length-1]!=="/"&&(u+="/")),!o||o.isDirectory){let P=[],N=[],T={};for(let C in a)if(Object.prototype.hasOwnProperty.call(a,C)&&C.lastIndexOf(u,0)===0){let _=C.replace(u,""),Mt=a[C];if(Mt.isFile&&(P.push(Mt),_=rt.dirname(_)),_&&!T[_]&&_!=="."){T[_]=!0;let Y=_.split("/").filter(ct=>ct);for(Y.length&&N.push(Y);Y.length>1;){Y=Y.slice(0,Y.length-1);let ct=Y.join("/");if(T[ct]||ct===".")break;T[ct]=!0,N.push(Y)}}}N.sort((C,_)=>C.length-_.length),N.length?D(h,N,C=>{C?m(C):it(h,u,P,m,0)}):it(h,u,P,m,0)}else B.stat(h,(P,N)=>{N&&N.isDirectory()?k(o,rt.join(h,rt.basename(o.name)),m):k(o,h,m)})},this.close=function(o){r||!t?(r=!0,o&&o()):(r=!0,B.close(t,h=>{t=null,o&&o(h)}))};let W=Ct.EventEmitter.prototype.emit;this.emit=function(...o){if(!r)return W.call(this,...o)}};Q.setFs=function(d){B=d};Q.debugLog=(...d)=>{Q.debug&&console.log(...d)};Qt.inherits(Q,Ct.EventEmitter);var V=Symbol("zip");Q.async=class extends Ct.EventEmitter{constructor(t){super();let e=new Q(t);e.on("entry",s=>this.emit("entry",s)),e.on("extract",(s,i)=>this.emit("extract",s,i)),this[V]=new Promise((s,i)=>{e.on("ready",()=>{e.removeListener("error",i),s(e)}),e.on("error",i)})}get entriesCount(){return this[V].then(t=>t.entriesCount)}get comment(){return this[V].then(t=>t.comment)}async entry(t){return(await this[V]).entry(t)}async entries(){return(await this[V]).entries()}async stream(t){let e=await this[V];return new Promise((s,i)=>{e.stream(t,(n,r)=>{n?i(n):s(r)})})}async entryData(t){let e=await this.stream(t);return new Promise((s,i)=>{let n=[];e.on("data",r=>n.push(r)),e.on("end",()=>{s(Buffer.concat(n))}),e.on("error",r=>{e.removeAllListeners("end"),i(r)})})}async extract(t,e){let s=await this[V];return new Promise((i,n)=>{s.extract(t,e,(r,p)=>{r?n(r):i(p)})})}async close(){let t=await this[V];return new Promise((e,s)=>{t.close(i=>{i?s(i):e()})})}};var Nt=class{read(t){if(t.length!==g.ENDHDR||t.readUInt32LE(0)!==g.ENDSIG)throw new Error("Invalid central directory");this.volumeEntries=t.readUInt16LE(g.ENDSUB),this.totalEntries=t.readUInt16LE(g.ENDTOT),this.size=t.readUInt32LE(g.ENDSIZ),this.offset=t.readUInt32LE(g.ENDOFF),this.commentLength=t.readUInt16LE(g.ENDCOM)}},Pt=class{read(t){if(t.length!==g.ENDL64HDR||t.readUInt32LE(0)!==g.ENDL64SIG)throw new Error("Invalid zip64 central directory locator");this.headerOffset=X(t,g.ENDSUB)}},bt=class{read(t){if(t.length!==g.END64HDR||t.readUInt32LE(0)!==g.END64SIG)throw new Error("Invalid central directory");this.volumeEntries=X(t,g.END64SUB),this.totalEntries=X(t,g.END64TOT),this.size=X(t,g.END64SIZ),this.offset=X(t,g.END64OFF)}},xt=class{readHeader(t,e){if(t.length<e+g.CENHDR||t.readUInt32LE(e)!==g.CENSIG)throw new Error("Invalid entry header");this.verMade=t.readUInt16LE(e+g.CENVEM),this.version=t.readUInt16LE(e+g.CENVER),this.flags=t.readUInt16LE(e+g.CENFLG),this.method=t.readUInt16LE(e+g.CENHOW);let s=t.readUInt16LE(e+g.CENTIM),i=t.readUInt16LE(e+g.CENTIM+2);this.time=At(s,i),this.crc=t.readUInt32LE(e+g.CENCRC),this.compressedSize=t.readUInt32LE(e+g.CENSIZ),this.size=t.readUInt32LE(e+g.CENLEN),this.fnameLen=t.readUInt16LE(e+g.CENNAM),this.extraLen=t.readUInt16LE(e+g.CENEXT),this.comLen=t.readUInt16LE(e+g.CENCOM),this.diskStart=t.readUInt16LE(e+g.CENDSK),this.inattr=t.readUInt16LE(e+g.CENATT),this.attr=t.readUInt32LE(e+g.CENATX),this.offset=t.readUInt32LE(e+g.CENOFF)}readDataHeader(t){if(t.readUInt32LE(0)!==g.LOCSIG)throw new Error("Invalid local header");this.version=t.readUInt16LE(g.LOCVER),this.flags=t.readUInt16LE(g.LOCFLG),this.method=t.readUInt16LE(g.LOCHOW);let e=t.readUInt16LE(g.LOCTIM),s=t.readUInt16LE(g.LOCTIM+2);this.time=At(e,s),this.crc=t.readUInt32LE(g.LOCCRC)||this.crc;let i=t.readUInt32LE(g.LOCSIZ);i&&i!==g.EF_ZIP64_OR_32&&(this.compressedSize=i);let n=t.readUInt32LE(g.LOCLEN);n&&n!==g.EF_ZIP64_OR_32&&(this.size=n),this.fnameLen=t.readUInt16LE(g.LOCNAM),this.extraLen=t.readUInt16LE(g.LOCEXT)}read(t,e,s){let i=t.slice(e,e+=this.fnameLen);this.name=s?s.decode(new Uint8Array(i)):i.toString("utf8");let n=t[e-1];this.isDirectory=n===47||n===92,this.extraLen&&(this.readExtra(t,e),e+=this.extraLen),this.comment=this.comLen?t.slice(e,e+this.comLen).toString():null}validateName(){if(/\\|^\w+:|^\/|(^|\/)\.\.(\/|$)/.test(this.name))throw new Error("Malicious entry: "+this.name)}readExtra(t,e){let s,i,n=e+this.extraLen;for(;e<n;)s=t.readUInt16LE(e),e+=2,i=t.readUInt16LE(e),e+=2,g.ID_ZIP64===s&&this.parseZip64Extra(t,e,i),e+=i}parseZip64Extra(t,e,s){s>=8&&this.size===g.EF_ZIP64_OR_32&&(this.size=X(t,e),e+=8,s-=8),s>=8&&this.compressedSize===g.EF_ZIP64_OR_32&&(this.compressedSize=X(t,e),e+=8,s-=8),s>=8&&this.offset===g.EF_ZIP64_OR_32&&(this.offset=X(t,e),e+=8,s-=8),s>=4&&this.diskStart===g.EF_ZIP64_OR_16&&(this.diskStart=t.readUInt32LE(e))}get encrypted(){return(this.flags&g.FLG_ENTRY_ENC)===g.FLG_ENTRY_ENC}get isFile(){return!this.isDirectory}},q=class{constructor(t,e,s,i,n,r){this.fd=t,this.buffer=e,this.offset=s,this.length=i,this.position=n,this.callback=r,this.bytesRead=0,this.waiting=!1}read(t){Q.debugLog("read",this.position,this.bytesRead,this.length,this.offset),this.waiting=!0;let e;if(t){let s=0;try{s=B.readSync(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead)}catch(i){e=i}this.readCallback(t,e,e?s:null)}else B.read(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead,this.readCallback.bind(this,t))}readCallback(t,e,s){if(typeof s=="number"&&(this.bytesRead+=s),e||!s||this.bytesRead===this.length)return this.waiting=!1,this.callback(e,this.bytesRead);this.read(t)}},dt=class{constructor(t){this.position=0,this.buffer=Buffer.alloc(0),this.fd=t,this.fsOp=null}checkOp(){if(this.fsOp&&this.fsOp.waiting)throw new Error("Operation in progress")}read(t,e,s){this.checkOp(),this.buffer.length<e&&(this.buffer=Buffer.alloc(e)),this.position=t,this.fsOp=new q(this.fd,this.buffer,0,e,this.position,s).read()}expandLeft(t,e){this.checkOp(),this.buffer=Buffer.concat([Buffer.alloc(t),this.buffer]),this.position-=t,this.position<0&&(this.position=0),this.fsOp=new q(this.fd,this.buffer,0,t,this.position,e).read()}expandRight(t,e){this.checkOp();let s=this.buffer.length;this.buffer=Buffer.concat([this.buffer,Buffer.alloc(t)]),this.fsOp=new q(this.fd,this.buffer,s,t,this.position+s,e).read()}moveRight(t,e,s){this.checkOp(),s?this.buffer.copy(this.buffer,0,s):s=0,this.position+=s,this.fsOp=new q(this.fd,this.buffer,this.buffer.length-s,s,this.position+this.buffer.length-s,e).read()}},Tt=class extends Ot.Readable{constructor(t,e,s){super(),this.fd=t,this.offset=e,this.length=s,this.pos=0,this.readCallback=this.readCallback.bind(this)}_read(t){let e=Buffer.alloc(Math.min(t,this.length-this.pos));e.length?B.read(this.fd,e,0,e.length,this.offset+this.pos,this.readCallback):this.push(null)}readCallback(t,e,s){this.pos+=e,t?(this.emit("error",t),this.push(null)):e?(e!==s.length&&(s=s.slice(0,e)),this.push(s)):this.push(null)}},Dt=class extends Ot.Transform{constructor(t,e,s){super(),this.verify=new J(e,s),t.on("error",i=>{this.emit("error",i)})}_transform(t,e,s){let i;try{this.verify.data(t)}catch(n){i=n}s(i,t)}},J=class{constructor(t,e){this.crc=t,this.size=e,this.state={crc:-1,size:0}}data(t){let e=J.getCrcTable(),s=this.state.crc,i=0,n=t.length;for(;--n>=0;)s=e[(s^t[i++])&255]^s>>>8;if(this.state.crc=s,this.state.size+=t.length,this.state.size>=this.size){let r=Buffer.alloc(4);if(r.writeInt32LE(~this.state.crc&4294967295,0),s=r.readUInt32LE(0),s!==this.crc)throw new Error("Invalid CRC");if(this.state.size!==this.size)throw new Error("Invalid size")}}static getCrcTable(){let t=J.crcTable;if(!t){J.crcTable=t=[];let e=Buffer.alloc(4);for(let s=0;s<256;s++){let i=s;for(let n=8;--n>=0;)i&1?i=3988292384^i>>>1:i=i>>>1;i<0&&(e.writeInt32LE(i,0),i=e.readUInt32LE(0)),t[s]=i}}return t}};function At(d,t){let e=kt(d,16),s=kt(t,16),i={h:parseInt(e.slice(0,5).join(""),2),m:parseInt(e.slice(5,11).join(""),2),s:parseInt(e.slice(11,16).join(""),2)*2,Y:parseInt(s.slice(0,7).join(""),2)+1980,M:parseInt(s.slice(7,11).join(""),2),D:parseInt(s.slice(11,16).join(""),2)},n=[i.Y,i.M,i.D].join("-")+" "+[i.h,i.m,i.s].join(":")+" GMT+0";return new Date(n).getTime()}function kt(d,t){let e=(d>>>0).toString(2);for(;e.length<t;)e="0"+e;return e.split("")}function X(d,t){return d.readUInt32LE(t+4)*4294967296+d.readUInt32LE(t)}Bt.exports=Q});var te={};Vt(te,{default:()=>Lt});module.exports=qt(te);var R=require("obsidian");var $={watchedFolderPath:"",notesFolderPath:"KrispNotes/Notes",attachmentsFolderPath:"KrispNotes/Attachments",noteNameTemplate:"{{YYYY}}-{{MM}}-{{DD}}_{{HHMM}}_{{meetingTitle}}",attachmentNameTemplate:"{{YYYY}}-{{MM}}-{{DD}}_{{meetingTitle}}_audio",noteContentTemplate:`---
title: {{meetingTitle}}
date: {{date}}
time: {{time}}
type: meeting
source: krisp
tags:
{{yamlTags}}
  - meeting
  - krisp
audio: "{{audioPathForYaml}}"
participants: [{{participants}}]
duration: {{duration}}
meeting_stats:
  participants_count: {{participantsCount}}
  transcript_length: {{transcriptWords}}
  most_active_speaker: "{{mostActiveSpeaker}}"
---

# \u{1F399}\uFE0F {{meetingTitle}}

> [!info]+ \u{1F4CB} \u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043E \u0432\u0441\u0442\u0440\u0435\u0447\u0435
>
> **\u{1F4C5} \u0414\u0430\u0442\u0430:** {{date}}
> **\u23F0 \u0412\u0440\u0435\u043C\u044F:** {{time}}
> **\u23F1\uFE0F \u0414\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C:** {{duration}}
> **\u{1F465} \u0423\u0447\u0430\u0441\u0442\u043D\u0438\u043A\u0438:** {{participantsCount}} \u0447\u0435\u043B\u043E\u0432\u0435\u043A
> **\u{1F4CA} \u0421\u043B\u043E\u0432 \u0432 \u0442\u0440\u0430\u043D\u0441\u043A\u0440\u0438\u043F\u0442\u0435:** {{transcriptWords}}
> **\u{1F5E3}\uFE0F \u0421\u0430\u043C\u044B\u0439 \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0439:** {{mostActiveSpeaker}}

---

## \u{1F3A7} \u0410\u0443\u0434\u0438\u043E\u0437\u0430\u043F\u0438\u0441\u044C

![[{{audioPathForYaml}}]]

*\u0414\u043B\u044F \u0432\u043E\u0441\u043F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u044F \u0430\u0443\u0434\u0438\u043E \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 \u0432\u0441\u0442\u0440\u043E\u0435\u043D\u043D\u044B\u0439 \u043F\u043B\u0435\u0435\u0440 Obsidian \u0438\u043B\u0438 \u043E\u0442\u043A\u0440\u043E\u0439\u0442\u0435 \u0444\u0430\u0439\u043B: [[{{audioPathForYaml}}]]*

---

## \u{1F4DD} \u041A\u0440\u0430\u0442\u043A\u043E\u0435 \u0441\u043E\u0434\u0435\u0440\u0436\u0430\u043D\u0438\u0435

> [!note]+ \u{1F4A1} \u041E\u0441\u043D\u043E\u0432\u043D\u044B\u0435 \u043C\u043E\u043C\u0435\u043D\u0442\u044B \u0432\u0441\u0442\u0440\u0435\u0447\u0438
>
> {{summary}}

---

## \u{1F465} \u0423\u0447\u0430\u0441\u0442\u043D\u0438\u043A\u0438 \u0432\u0441\u0442\u0440\u0435\u0447\u0438

{{participantsList}}

### \u{1F4C8} \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430 \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0438

{{participantsStats}}

---

## \u2705 \u0417\u0430\u0434\u0430\u0447\u0438 \u0438 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F

> [!todo]+ \u{1F4CB} Action Items
>
> {{actionItemsList}}

---

## \u{1F511} \u041A\u043B\u044E\u0447\u0435\u0432\u044B\u0435 \u043C\u043E\u043C\u0435\u043D\u0442\u044B

> [!important]+ \u2B50 Key Points
>
> {{keyPointsList}}

---

## \u{1F3F7}\uFE0F \u0418\u0437\u0432\u043B\u0435\u0447\u0435\u043D\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F

{{extractedEntities}}

---

## \u{1F4CB} \u041F\u043E\u043B\u043D\u0430\u044F \u0442\u0440\u0430\u043D\u0441\u043A\u0440\u0438\u043F\u0446\u0438\u044F

> [!quote]- \u{1F399}\uFE0F \u0422\u0440\u0430\u043D\u0441\u043A\u0440\u0438\u043F\u0442 \u0432\u0441\u0442\u0440\u0435\u0447\u0438 ({{transcriptWords}} \u0441\u043B\u043E\u0432)
>
> {{formattedTranscript}}

---

## \u{1F517} \u0421\u0432\u044F\u0437\u0430\u043D\u043D\u044B\u0435 \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u044B

- \u{1F4C4} **\u0417\u0430\u043C\u0435\u0442\u043A\u0430:** [[{{noteFileName}}]]
- \u{1F3B5} **\u0410\u0443\u0434\u0438\u043E\u0444\u0430\u0439\u043B:** [[{{audioPathForYaml}}]]

{{relatedLinks}}

---

## \u{1F4CA} \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430 \u0432\u0441\u0442\u0440\u0435\u0447\u0438

| \u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440 | \u0417\u043D\u0430\u0447\u0435\u043D\u0438\u0435 |
|----------|----------|
| \u{1F4C5} \u0414\u0430\u0442\u0430 | {{date}} |
| \u23F0 \u0412\u0440\u0435\u043C\u044F \u043D\u0430\u0447\u0430\u043B\u0430 | {{time}} |
| \u23F1\uFE0F \u0414\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C | {{duration}} |
| \u{1F465} \u0423\u0447\u0430\u0441\u0442\u043D\u0438\u043A\u043E\u0432 | {{participantsCount}} |
| \u{1F4DD} \u0421\u043B\u043E\u0432 \u0432 \u0442\u0440\u0430\u043D\u0441\u043A\u0440\u0438\u043F\u0442\u0435 | {{transcriptWords}} |
| \u{1F5E3}\uFE0F \u0421\u0430\u043C\u044B\u0439 \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0439 | {{mostActiveSpeaker}} |

---

> [!tip]+ \u{1F916} \u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043E\u0431 \u0438\u043C\u043F\u043E\u0440\u0442\u0435
>
> **\u0421\u043E\u0437\u0434\u0430\u043D\u043E:** Krisp Notes Importer
> **\u0418\u043C\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u043E:** {{importDate}}
> **\u0418\u0441\u0442\u043E\u0447\u043D\u0438\u043A:** Krisp Meeting Archive
`,duplicateStrategy:"rename",deleteZipAfterImport:!1,openNoteAfterImport:!0,autoScanEnabled:!1,language:"en"};var ut=class{constructor(t){this.plugin=t}async loadSettings(){this.settings=Object.assign({},$,await this.plugin.loadData())}async saveSettings(){await this.plugin.saveData(this.settings)}getSetting(t){return this.settings?this.settings[t]:$[t]}getAllSettings(){return this.settings||$}async updateSetting(t,e){this.settings||await this.loadSettings(),this.settings[t]=e,await this.saveSettings()}validateSettings(){let t=[];return(!this.settings.watchedFolderPath||this.settings.watchedFolderPath.trim()==="")&&t.push("\u041F\u0443\u0442\u044C \u043A \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u0435\u043C\u043E\u0439 \u043F\u0430\u043F\u043A\u0435 \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C"),(!this.settings.notesFolderPath||this.settings.notesFolderPath.trim()==="")&&t.push("\u041F\u0443\u0442\u044C \u043A \u043F\u0430\u043F\u043A\u0435 \u0437\u0430\u043C\u0435\u0442\u043E\u043A \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C"),(!this.settings.attachmentsFolderPath||this.settings.attachmentsFolderPath.trim()==="")&&t.push("\u041F\u0443\u0442\u044C \u043A \u043F\u0430\u043F\u043A\u0435 \u0432\u043B\u043E\u0436\u0435\u043D\u0438\u0439 \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C"),(!this.settings.noteNameTemplate||this.settings.noteNameTemplate.trim()==="")&&t.push("Note name template cannot be empty"),(!this.settings.attachmentNameTemplate||this.settings.attachmentNameTemplate.trim()==="")&&t.push("Audio name template cannot be empty"),["skip","overwrite","rename"].includes(this.settings.duplicateStrategy)||t.push(`\u041D\u0435\u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u0430\u044F \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044F \u0434\u0443\u0431\u043B\u0438\u043A\u0430\u0442\u043E\u0432: ${this.settings.duplicateStrategy}`),["en","ru"].includes(this.settings.language)||t.push(`\u041D\u0435\u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u044B\u0439 \u044F\u0437\u044B\u043A: ${this.settings.language}`),{isValid:t.length===0,errors:t}}getValidatedSettings(){let t=this.validateSettings();return t.isValid?this.settings:(console.warn("[Krisp Importer] Settings contain errors:",t.errors),this.getSettingsWithDefaults())}getSettingsWithDefaults(){var t,e,s,i,n;return{...$,...this.settings,watchedFolderPath:((t=this.settings.watchedFolderPath)==null?void 0:t.trim())||$.watchedFolderPath,notesFolderPath:((e=this.settings.notesFolderPath)==null?void 0:e.trim())||$.notesFolderPath,attachmentsFolderPath:((s=this.settings.attachmentsFolderPath)==null?void 0:s.trim())||$.attachmentsFolderPath,noteNameTemplate:((i=this.settings.noteNameTemplate)==null?void 0:i.trim())||$.noteNameTemplate,attachmentNameTemplate:((n=this.settings.attachmentNameTemplate)==null?void 0:n.trim())||$.attachmentNameTemplate,duplicateStrategy:["skip","overwrite","rename"].includes(this.settings.duplicateStrategy)?this.settings.duplicateStrategy:$.duplicateStrategy,language:["en","ru"].includes(this.settings.language)?this.settings.language:$.language}}};var I=require("obsidian");var Xt={settings:{title:"Krisp Notes Importer Settings",sections:{basic:"\u{1F527} Basic Settings",storage:"\u{1F4BE} Obsidian Storage",templates:"\u{1F4DD} Templates & Naming",duplicates:"\u{1F504} Duplicate Handling",postImport:"\u26A1 Post-Import Actions",advanced:"\u{1F6E0}\uFE0F Advanced & Maintenance"},fields:{watchedFolder:{name:"Watched Folder Path",desc:"Full path to the folder where Krisp saves ZIP archives"},autoScan:{name:"Enable Auto-Watching",desc:"Automatically monitor the folder for new ZIP files"},notesFolder:{name:"Notes Folder",desc:"Folder in your Obsidian vault for saving meeting notes"},attachmentsFolder:{name:"Attachments Folder",desc:"Folder in your Obsidian vault for saving audio files"},noteNameTemplate:{name:"Note Name Template",desc:"Template for naming note files. Available variables: {{YYYY}}, {{MM}}, {{DD}}, {{HHMM}}, {{meetingTitle}}"},attachmentNameTemplate:{name:"Audio Name Template",desc:"Template for naming audio files. Same variables available"},noteContentTemplate:{name:"Note Content Template",desc:"Template for note content. Available variables: {{title}}, {{date}}, {{time}}, {{participants}}, {{summary}}, {{actionItems}}, {{keyPoints}}, {{transcript}}, {{audioLink}}"},duplicateStrategy:{name:"Duplicate Strategy",desc:"What to do when a meeting with the same name already exists",options:{skip:"Skip import",overwrite:"Overwrite existing",rename:"Create with suffix"}},deleteZipAfterImport:{name:"Delete ZIP after import",desc:"Automatically delete the ZIP file after successful import"},openNoteAfterImport:{name:"Open note after import",desc:"Automatically open the created note in Obsidian"},language:{name:"Interface Language",desc:"Choose the language for the plugin interface"}},buttons:{testImport:"Test Import",massImport:"Import All Files",resetSettings:"Reset Settings",showLogs:"Show Logs",restoreTemplate:"Restore Default Template"},info:{title:"Plugin Information",version:"Version",status:"Status",features:["\u2705 Manual ZIP import","\u2705 Automatic folder watching","\u2705 Beautiful note formatting with callouts","\u2705 Advanced participant analytics","\u2705 Complete UI settings","\u2705 Logging and diagnostic system","\u2705 Bilingual support (English/Russian)"],commands:["Import ZIP file manually","Start auto-watching folder","Stop auto-watching","Scan existing files","Check watching status","Debug current settings"]}},commands:{importZip:"Import ZIP file manually",startWatching:"Start auto-watching folder",stopWatching:"Stop auto-watching",scanExisting:"Scan existing files in folder",checkStatus:"Check watching status",debugSettings:"Debug current settings"},notifications:{success:{imported:"Meeting '{{title}}' imported successfully!",watchingStarted:"Auto-watching started for: {{path}}",watchingStopped:"Auto-watching stopped",settingsReset:"Settings reset to defaults"},error:{invalidZip:"Invalid ZIP file: {{file}}",missingFiles:"Required files not found in: {{file}}",createNote:"Failed to create note for: {{title}}",copyAudio:"Failed to copy audio file for: {{title}}",watchingFailed:"Failed to start watching: {{error}}"},warning:{duplicateSkipped:"Meeting '{{title}}' already exists - skipped",duplicateRenamed:"Meeting '{{title}}' already exists - created as '{{newTitle}}'",duplicateOverwritten:"Meeting '{{title}}' already exists - overwritten"},info:{processing:"Processing: {{file}}",scanningFolder:"Scanning folder for ZIP files..."}},statusBar:{idle:"Idle",watching:"Watching: {{path}}",processing:"Processing...",error:"Error: {{message}}"},modals:{testImport:{title:"Test Import ZIP File",placeholder:"Enter full path to ZIP file...",button:"Test Import"},confirmReset:{title:"Reset Settings",message:"Are you sure you want to reset all settings to defaults? This action cannot be undone.",confirm:"Reset",cancel:"Cancel"},logs:{title:"Plugin Logs",export:"Export",clear:"Clear",close:"Close"}}},Jt={settings:{title:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 Krisp Notes Importer",sections:{basic:"\u{1F527} \u041E\u0441\u043D\u043E\u0432\u043D\u044B\u0435 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",storage:"\u{1F4BE} \u0425\u0440\u0430\u043D\u0435\u043D\u0438\u0435 \u0432 Obsidian",templates:"\u{1F4DD} \u0428\u0430\u0431\u043B\u043E\u043D\u044B \u0438 \u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",duplicates:"\u{1F504} \u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430 \u0434\u0443\u0431\u043B\u0438\u043A\u0430\u0442\u043E\u0432",postImport:"\u26A1 \u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F \u043F\u043E\u0441\u043B\u0435 \u0438\u043C\u043F\u043E\u0440\u0442\u0430",advanced:"\u{1F6E0}\uFE0F \u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0438 \u043E\u0431\u0441\u043B\u0443\u0436\u0438\u0432\u0430\u043D\u0438\u0435"},fields:{watchedFolder:{name:"\u041E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u0435\u043C\u0430\u044F \u043F\u0430\u043F\u043A\u0430",desc:"\u041F\u043E\u043B\u043D\u044B\u0439 \u043F\u0443\u0442\u044C \u043A \u043F\u0430\u043F\u043A\u0435, \u0433\u0434\u0435 Krisp \u0441\u043E\u0445\u0440\u0430\u043D\u044F\u0435\u0442 ZIP-\u0430\u0440\u0445\u0438\u0432\u044B"},autoScan:{name:"\u0412\u043A\u043B\u044E\u0447\u0438\u0442\u044C \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u043E\u0435 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435",desc:"\u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u0442\u044C \u043F\u0430\u043F\u043A\u0443 \u043D\u0430 \u043F\u0440\u0435\u0434\u043C\u0435\u0442 \u043D\u043E\u0432\u044B\u0445 ZIP-\u0444\u0430\u0439\u043B\u043E\u0432"},notesFolder:{name:"\u041F\u0430\u043F\u043A\u0430 \u0434\u043B\u044F \u0437\u0430\u043C\u0435\u0442\u043E\u043A",desc:"\u041F\u0430\u043F\u043A\u0430 \u0432 \u0432\u0430\u0448\u0435\u043C \u0445\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0435 Obsidian \u0434\u043B\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u0437\u0430\u043C\u0435\u0442\u043E\u043A \u0432\u0441\u0442\u0440\u0435\u0447"},attachmentsFolder:{name:"\u041F\u0430\u043F\u043A\u0430 \u0434\u043B\u044F \u0432\u043B\u043E\u0436\u0435\u043D\u0438\u0439",desc:"\u041F\u0430\u043F\u043A\u0430 \u0432 \u0432\u0430\u0448\u0435\u043C \u0445\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0435 Obsidian \u0434\u043B\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u0430\u0443\u0434\u0438\u043E\u0444\u0430\u0439\u043B\u043E\u0432"},noteNameTemplate:{name:"\u0428\u0430\u0431\u043B\u043E\u043D \u0438\u043C\u0435\u043D\u0438 \u0437\u0430\u043C\u0435\u0442\u043A\u0438",desc:"\u0428\u0430\u0431\u043B\u043E\u043D \u0434\u043B\u044F \u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u044F \u0444\u0430\u0439\u043B\u043E\u0432 \u0437\u0430\u043C\u0435\u0442\u043E\u043A. \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0435 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0435: {{YYYY}}, {{MM}}, {{DD}}, {{HHMM}}, {{meetingTitle}}"},attachmentNameTemplate:{name:"\u0428\u0430\u0431\u043B\u043E\u043D \u0438\u043C\u0435\u043D\u0438 \u0430\u0443\u0434\u0438\u043E",desc:"\u0428\u0430\u0431\u043B\u043E\u043D \u0434\u043B\u044F \u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u044F \u0430\u0443\u0434\u0438\u043E\u0444\u0430\u0439\u043B\u043E\u0432. \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u044B \u0442\u0435 \u0436\u0435 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0435"},noteContentTemplate:{name:"\u0428\u0430\u0431\u043B\u043E\u043D \u0441\u043E\u0434\u0435\u0440\u0436\u0438\u043C\u043E\u0433\u043E \u0437\u0430\u043C\u0435\u0442\u043A\u0438",desc:"\u0428\u0430\u0431\u043B\u043E\u043D \u0434\u043B\u044F \u0441\u043E\u0434\u0435\u0440\u0436\u0438\u043C\u043E\u0433\u043E \u0437\u0430\u043C\u0435\u0442\u043A\u0438. \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0435 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0435: {{title}}, {{date}}, {{time}}, {{participants}}, {{summary}}, {{actionItems}}, {{keyPoints}}, {{transcript}}, {{audioLink}}"},duplicateStrategy:{name:"\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044F \u0434\u0443\u0431\u043B\u0438\u043A\u0430\u0442\u043E\u0432",desc:"\u0427\u0442\u043E \u0434\u0435\u043B\u0430\u0442\u044C, \u043A\u043E\u0433\u0434\u0430 \u0432\u0441\u0442\u0440\u0435\u0447\u0430 \u0441 \u0442\u0430\u043A\u0438\u043C \u0436\u0435 \u0438\u043C\u0435\u043D\u0435\u043C \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442",options:{skip:"\u041F\u0440\u043E\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u0438\u043C\u043F\u043E\u0440\u0442",overwrite:"\u041F\u0435\u0440\u0435\u0437\u0430\u043F\u0438\u0441\u0430\u0442\u044C \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0443\u044E",rename:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0441 \u0441\u0443\u0444\u0444\u0438\u043A\u0441\u043E\u043C"}},deleteZipAfterImport:{name:"\u0423\u0434\u0430\u043B\u044F\u0442\u044C ZIP \u043F\u043E\u0441\u043B\u0435 \u0438\u043C\u043F\u043E\u0440\u0442\u0430",desc:"\u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438 \u0443\u0434\u0430\u043B\u044F\u0442\u044C ZIP-\u0444\u0430\u0439\u043B \u043F\u043E\u0441\u043B\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E\u0433\u043E \u0438\u043C\u043F\u043E\u0440\u0442\u0430"},openNoteAfterImport:{name:"\u041E\u0442\u043A\u0440\u044B\u0432\u0430\u0442\u044C \u0437\u0430\u043C\u0435\u0442\u043A\u0443 \u043F\u043E\u0441\u043B\u0435 \u0438\u043C\u043F\u043E\u0440\u0442\u0430",desc:"\u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438 \u043E\u0442\u043A\u0440\u044B\u0432\u0430\u0442\u044C \u0441\u043E\u0437\u0434\u0430\u043D\u043D\u0443\u044E \u0437\u0430\u043C\u0435\u0442\u043A\u0443 \u0432 Obsidian"},language:{name:"\u042F\u0437\u044B\u043A \u0438\u043D\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430",desc:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u044F\u0437\u044B\u043A \u0434\u043B\u044F \u0438\u043D\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u043F\u043B\u0430\u0433\u0438\u043D\u0430"}},buttons:{testImport:"\u0422\u0435\u0441\u0442\u043E\u0432\u044B\u0439 \u0438\u043C\u043F\u043E\u0440\u0442",massImport:"\u0418\u043C\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0432\u0441\u0435 \u0444\u0430\u0439\u043B\u044B",resetSettings:"\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",showLogs:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043B\u043E\u0433\u0438",restoreTemplate:"\u0412\u043E\u0441\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0441\u0442\u0430\u043D\u0434\u0430\u0440\u0442\u043D\u044B\u0439 \u0448\u0430\u0431\u043B\u043E\u043D"},info:{title:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043E \u043F\u043B\u0430\u0433\u0438\u043D\u0435",version:"\u0412\u0435\u0440\u0441\u0438\u044F",status:"\u0421\u0442\u0430\u0442\u0443\u0441",features:["\u2705 \u0420\u0443\u0447\u043D\u043E\u0439 \u0438\u043C\u043F\u043E\u0440\u0442 ZIP","\u2705 \u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u043E\u0435 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438","\u2705 \u041A\u0440\u0430\u0441\u0438\u0432\u043E\u0435 \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u043C\u0435\u0442\u043E\u043A \u0441 callouts","\u2705 \u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u043D\u0430\u044F \u0430\u043D\u0430\u043B\u0438\u0442\u0438\u043A\u0430 \u0443\u0447\u0430\u0441\u0442\u043D\u0438\u043A\u043E\u0432","\u2705 \u041F\u043E\u043B\u043D\u044B\u0439 UI \u043D\u0430\u0441\u0442\u0440\u043E\u0435\u043A","\u2705 \u0421\u0438\u0441\u0442\u0435\u043C\u0430 \u043B\u043E\u0433\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u0438 \u0434\u0438\u0430\u0433\u043D\u043E\u0441\u0442\u0438\u043A\u0438","\u2705 \u0414\u0432\u0443\u044F\u0437\u044B\u0447\u043D\u0430\u044F \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0430 (English/\u0420\u0443\u0441\u0441\u043A\u0438\u0439)"],commands:["\u0420\u0443\u0447\u043D\u043E\u0439 \u0438\u043C\u043F\u043E\u0440\u0442 ZIP-\u0444\u0430\u0439\u043B\u0430","\u0417\u0430\u043F\u0443\u0441\u043A \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u043E\u0433\u043E \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u044F \u043F\u0430\u043F\u043A\u0438","\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u043E\u0433\u043E \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u044F","\u0421\u043A\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0445 \u0444\u0430\u0439\u043B\u043E\u0432","\u041F\u0440\u043E\u0432\u0435\u0440\u043A\u0430 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u044F","\u041E\u0442\u043B\u0430\u0434\u043A\u0430 \u0442\u0435\u043A\u0443\u0449\u0438\u0445 \u043D\u0430\u0441\u0442\u0440\u043E\u0435\u043A"]}},commands:{importZip:"\u0420\u0443\u0447\u043D\u043E\u0439 \u0438\u043C\u043F\u043E\u0440\u0442 ZIP-\u0444\u0430\u0439\u043B\u0430",startWatching:"\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u043E\u0435 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438",stopWatching:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u043E\u0435 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435",scanExisting:"\u0421\u043A\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0435 \u0444\u0430\u0439\u043B\u044B \u0432 \u043F\u0430\u043F\u043A\u0435",checkStatus:"\u041F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C \u0441\u0442\u0430\u0442\u0443\u0441 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u044F",debugSettings:"\u041E\u0442\u043B\u0430\u0434\u043A\u0430 \u0442\u0435\u043A\u0443\u0449\u0438\u0445 \u043D\u0430\u0441\u0442\u0440\u043E\u0435\u043A"},notifications:{success:{imported:"\u0412\u0441\u0442\u0440\u0435\u0447\u0430 '{{title}}' \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0438\u043C\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0430!",watchingStarted:"\u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u043E\u0435 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u0437\u0430\u043F\u0443\u0449\u0435\u043D\u043E \u0434\u043B\u044F: {{path}}",watchingStopped:"\u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u043E\u0435 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E",settingsReset:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u0441\u0431\u0440\u043E\u0448\u0435\u043D\u044B \u043A \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F\u043C \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E"},error:{invalidZip:"\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 ZIP-\u0444\u0430\u0439\u043B: {{file}}",missingFiles:"\u041D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u044B\u0435 \u0444\u0430\u0439\u043B\u044B \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u044B \u0432: {{file}}",createNote:"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0437\u0430\u043C\u0435\u0442\u043A\u0443 \u0434\u043B\u044F: {{title}}",copyAudio:"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0430\u0443\u0434\u0438\u043E\u0444\u0430\u0439\u043B \u0434\u043B\u044F: {{title}}",watchingFailed:"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435: {{error}}"},warning:{duplicateSkipped:"\u0412\u0441\u0442\u0440\u0435\u0447\u0430 '{{title}}' \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 - \u043F\u0440\u043E\u043F\u0443\u0449\u0435\u043D\u0430",duplicateRenamed:"\u0412\u0441\u0442\u0440\u0435\u0447\u0430 '{{title}}' \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 - \u0441\u043E\u0437\u0434\u0430\u043D\u0430 \u043A\u0430\u043A '{{newTitle}}'",duplicateOverwritten:"\u0412\u0441\u0442\u0440\u0435\u0447\u0430 '{{title}}' \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 - \u043F\u0435\u0440\u0435\u0437\u0430\u043F\u0438\u0441\u0430\u043D\u0430"},info:{processing:"\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430: {{file}}",scanningFolder:"\u0421\u043A\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438 \u043D\u0430 \u043F\u0440\u0435\u0434\u043C\u0435\u0442 ZIP-\u0444\u0430\u0439\u043B\u043E\u0432..."}},statusBar:{idle:"\u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435",watching:"\u041E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435: {{path}}",processing:"\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430...",error:"\u041E\u0448\u0438\u0431\u043A\u0430: {{message}}"},modals:{testImport:{title:"\u0422\u0435\u0441\u0442\u043E\u0432\u044B\u0439 \u0438\u043C\u043F\u043E\u0440\u0442 ZIP-\u0444\u0430\u0439\u043B\u0430",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043F\u043E\u043B\u043D\u044B\u0439 \u043F\u0443\u0442\u044C \u043A ZIP-\u0444\u0430\u0439\u043B\u0443...",button:"\u0422\u0435\u0441\u0442\u043E\u0432\u044B\u0439 \u0438\u043C\u043F\u043E\u0440\u0442"},confirmReset:{title:"\u0421\u0431\u0440\u043E\u0441 \u043D\u0430\u0441\u0442\u0440\u043E\u0435\u043A",message:"\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0441\u0431\u0440\u043E\u0441\u0438\u0442\u044C \u0432\u0441\u0435 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u043A \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F\u043C \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E? \u042D\u0442\u043E \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043D\u0435\u043B\u044C\u0437\u044F \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C.",confirm:"\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C",cancel:"\u041E\u0442\u043C\u0435\u043D\u0430"},logs:{title:"\u041B\u043E\u0433\u0438 \u043F\u043B\u0430\u0433\u0438\u043D\u0430",export:"\u042D\u043A\u0441\u043F\u043E\u0440\u0442",clear:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C",close:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C"}}},nt=class{constructor(t){this.currentLanguage="en";this.strings={en:Xt,ru:Jt};t&&(this.currentLanguage=t)}setLanguage(t){this.currentLanguage=t}getCurrentLanguage(){return this.currentLanguage}t(t,e){let s=t.split("."),i=this.strings[this.currentLanguage];for(let n of s)if(i&&typeof i=="object"&&n in i)i=i[n];else{i=this.strings.en;for(let r of s)if(i&&typeof i=="object"&&r in i)i=i[r];else return`[Missing: ${t}]`;break}if(typeof i!="string")return`[Invalid: ${t}]`;if(e)for(let[n,r]of Object.entries(e))i=i.replace(new RegExp(`{{${n}}}`,"g"),r);return i}getSettingsStrings(){return this.strings[this.currentLanguage].settings}getCommandStrings(){return this.strings[this.currentLanguage].commands}getNotificationStrings(){return this.strings[this.currentLanguage].notifications}getStatusBarStrings(){return this.strings[this.currentLanguage].statusBar}getModalStrings(){return this.strings[this.currentLanguage].modals}};var mt=class extends I.PluginSettingTab{constructor(e,s){super(e,s);this.plugin=s;let i=this.plugin.settingsManager.getSetting("language")||"en";this.localization=s.localizationService||new nt(i)}updateLanguage(e){this.localization.setLanguage(e),this.display()}display(){var l;let{containerEl:e}=this;e.empty(),e.createEl("h1",{text:this.localization.t("settings.title")}),e.createEl("p",{text:this.localization.t("settings.title")+" - "+this.localization.t("settings.sections.basic")}),new I.Setting(e).setName(this.localization.t("settings.fields.language.name")).setDesc(this.localization.t("settings.fields.language.desc")).addDropdown(a=>a.addOption("en","English").addOption("ru","\u0420\u0443\u0441\u0441\u043A\u0438\u0439").setValue(this.plugin.settingsManager.getSetting("language")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("language",c),this.updateLanguage(c)})),e.createEl("h2",{text:"\u{1F527} "+this.localization.t("settings.sections.basic")}),new I.Setting(e).setName(this.localization.t("settings.fields.watchedFolder.name")).setDesc(this.localization.t("settings.fields.watchedFolder.desc")).addText(a=>a.setPlaceholder("/Users/username/Downloads/Krisp").setValue(this.plugin.settingsManager.getSetting("watchedFolderPath")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("watchedFolderPath",c)})),new I.Setting(e).setName(this.localization.t("settings.fields.autoScan.name")).setDesc(this.localization.t("settings.fields.autoScan.desc")).addToggle(a=>a.setValue(this.plugin.settingsManager.getSetting("autoScanEnabled")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("autoScanEnabled",c)})),e.createEl("h2",{text:this.localization.t("settings.sections.storage")}),new I.Setting(e).setName(this.localization.t("settings.fields.notesFolder.name")).setDesc(this.localization.t("settings.fields.notesFolder.desc")).addText(a=>a.setPlaceholder("KrispNotes/Notes").setValue(this.plugin.settingsManager.getSetting("notesFolderPath")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("notesFolderPath",c)})),new I.Setting(e).setName(this.localization.t("settings.fields.attachmentsFolder.name")).setDesc(this.localization.t("settings.fields.attachmentsFolder.desc")).addText(a=>a.setPlaceholder("KrispNotes/Attachments").setValue(this.plugin.settingsManager.getSetting("attachmentsFolderPath")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("attachmentsFolderPath",c)})),e.createEl("h2",{text:this.localization.t("settings.sections.templates")}),new I.Setting(e).setName(this.localization.t("settings.fields.noteNameTemplate.name")).setDesc(this.localization.t("settings.fields.noteNameTemplate.desc")).addText(a=>a.setPlaceholder("{{YYYY}}-{{MM}}-{{DD}}_{{HHMM}}_{{meetingTitle}}").setValue(this.plugin.settingsManager.getSetting("noteNameTemplate")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("noteNameTemplate",c)})),new I.Setting(e).setName(this.localization.t("settings.fields.attachmentNameTemplate.name")).setDesc(this.localization.t("settings.fields.attachmentNameTemplate.desc")).addText(a=>a.setPlaceholder("{{YYYY}}-{{MM}}-{{DD}}_{{meetingTitle}}_audio").setValue(this.plugin.settingsManager.getSetting("attachmentNameTemplate")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("attachmentNameTemplate",c)})),e.createEl("h2",{text:this.localization.t("settings.sections.duplicates")}),new I.Setting(e).setName(this.localization.t("settings.fields.duplicateStrategy.name")).setDesc(this.localization.t("settings.fields.duplicateStrategy.desc")).addDropdown(a=>a.addOption("skip",this.localization.t("settings.fields.duplicateStrategy.options.skip")).addOption("overwrite",this.localization.t("settings.fields.duplicateStrategy.options.overwrite")).addOption("rename",this.localization.t("settings.fields.duplicateStrategy.options.rename")).setValue(this.plugin.settingsManager.getSetting("duplicateStrategy")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("duplicateStrategy",c)})),e.createEl("h2",{text:this.localization.t("settings.sections.postImport")}),new I.Setting(e).setName(this.localization.t("settings.fields.openNoteAfterImport.name")).setDesc(this.localization.t("settings.fields.openNoteAfterImport.desc")).addToggle(a=>a.setValue(this.plugin.settingsManager.getSetting("openNoteAfterImport")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("openNoteAfterImport",c)})),new I.Setting(e).setName(this.localization.t("settings.fields.deleteZipAfterImport.name")).setDesc(this.localization.t("settings.fields.deleteZipAfterImport.desc")).addToggle(a=>a.setValue(this.plugin.settingsManager.getSetting("deleteZipAfterImport")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("deleteZipAfterImport",c)})),e.createEl("h2",{text:this.localization.t("settings.sections.advanced")}),new I.Setting(e).setName(this.localization.t("settings.fields.noteContentTemplate.name")).setDesc(this.localization.t("settings.fields.noteContentTemplate.desc")).addTextArea(a=>(a.setValue(this.plugin.settingsManager.getSetting("noteContentTemplate")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("noteContentTemplate",c)}),a.inputEl.rows=10,a.inputEl.cols=50,a)).addButton(a=>a.setButtonText(this.localization.t("settings.buttons.restoreTemplate")).onClick(async()=>{await this.plugin.settingsManager.updateSetting("noteContentTemplate",$.noteContentTemplate),this.display(),new I.Notice(this.localization.t("notifications.success.settingsReset"),3e3)})),new I.Setting(e).setName(this.localization.t("settings.buttons.testImport")).setDesc("\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 ZIP-\u0444\u0430\u0439\u043B \u0434\u043B\u044F \u0442\u0435\u0441\u0442\u043E\u0432\u043E\u0433\u043E \u0438\u043C\u043F\u043E\u0440\u0442\u0430 \u0441 \u0442\u0435\u043A\u0443\u0449\u0438\u043C\u0438 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430\u043C\u0438").addButton(a=>a.setButtonText(this.localization.t("settings.buttons.testImport")).setClass("mod-cta").onClick(async()=>{let c=this.localization,f=this.plugin;new class extends I.Modal{constructor(v){super(v)}onOpen(){let{contentEl:v}=this;v.createEl("h2",{text:c.t("modals.testImport.title")});let S=v.createEl("input",{type:"text",placeholder:c.t("modals.testImport.placeholder")});S.style.width="100%",S.style.marginBottom="10px";let E=v.createEl("button",{text:c.t("modals.testImport.button"),cls:"mod-cta"});E.onclick=async()=>{let y=S.value.trim();if(y){this.close();let L=f;if(L.processingService)try{await L.processingService.processZipFile(y)}catch(x){new I.Notice(`Error: ${x.message}`,5e3)}}}}onClose(){let{contentEl:v}=this;v.empty()}}(this.app).open()})),new I.Setting(e).setName(this.localization.t("settings.buttons.massImport")).setDesc("\u0418\u043C\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0432\u0441\u0435 ZIP-\u0444\u0430\u0439\u043B\u044B \u0438\u0437 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u0435\u043C\u043E\u0439 \u043F\u0430\u043F\u043A\u0438").addButton(a=>a.setButtonText(this.localization.t("settings.buttons.massImport")).onClick(async()=>{let c=this.plugin;if(c.fileWatcherService&&c.fileWatcherService.scanExistingFiles)try{await c.fileWatcherService.scanExistingFiles(),new I.Notice(this.localization.t("notifications.info.scanningFolder"),3e3)}catch(f){new I.Notice(`Error: ${f.message}`,5e3)}else new I.Notice("FileWatcherService not available",3e3)})),new I.Setting(e).setName(this.localization.t("settings.buttons.showLogs")).setDesc("\u041F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u0434\u0435\u0442\u0430\u043B\u044C\u043D\u044B\u0435 \u043B\u043E\u0433\u0438 \u0440\u0430\u0431\u043E\u0442\u044B \u043F\u043B\u0430\u0433\u0438\u043D\u0430 \u0434\u043B\u044F \u0434\u0438\u0430\u0433\u043D\u043E\u0441\u0442\u0438\u043A\u0438 \u043F\u0440\u043E\u0431\u043B\u0435\u043C").addButton(a=>a.setButtonText(this.localization.t("settings.buttons.showLogs")).onClick(async()=>{let c=this.plugin;c.loggingService?new class extends I.Modal{constructor(w){super(w)}onOpen(){let{contentEl:w}=this;w.createEl("h2",{text:"\u{1F4CB} \u041B\u043E\u0433\u0438 \u043F\u043B\u0430\u0433\u0438\u043D\u0430 Krisp Notes Importer"});let v=c.loggingService.getLogStats(),S=w.createEl("div");S.style.marginBottom="15px",S.style.padding="10px",S.style.backgroundColor="var(--background-secondary)",S.style.borderRadius="5px",S.createEl("p",{text:`\u{1F4CA} \u0412\u0441\u0435\u0433\u043E \u0437\u0430\u043F\u0438\u0441\u0435\u0439: ${v.total}`});let E=Object.entries(v.byLevel).map(([A,z])=>`${A}: ${z}`).join(", ");S.createEl("p",{text:`\u{1F4C8} \u041F\u043E \u0443\u0440\u043E\u0432\u043D\u044F\u043C: ${E}`});let y=w.createEl("div");y.style.display="flex",y.style.gap="10px",y.style.marginBottom="15px";let L=y.createEl("button",{text:"\u{1F4CB} \u041A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043B\u043E\u0433\u0438"});L.className="mod-cta",L.onclick=async()=>{await c.loggingService.copyLogsToClipboard()};let x=y.createEl("button",{text:"\u{1F5D1}\uFE0F \u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C \u043B\u043E\u0433\u0438"});x.className="mod-warning",x.onclick=()=>{c.loggingService.clearLogs(),this.close(),new I.Notice("\u{1F5D1}\uFE0F Logs cleared",3e3)};let F=y.createEl("button",{text:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C"});F.onclick=()=>this.close();let b=w.createEl("div");b.style.maxHeight="400px",b.style.overflow="auto",b.style.border="1px solid var(--background-modifier-border)",b.style.borderRadius="5px",b.style.padding="10px",b.style.backgroundColor="var(--background-primary-alt)",b.style.fontFamily="monospace",b.style.fontSize="0.8em",b.style.whiteSpace="pre-wrap";let M=c.loggingService.getRecentLogs(100);if(M.length===0)b.textContent="\u041B\u043E\u0433\u0438 \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044E\u0442";else{let A=M.map(z=>{let U=z.timestamp.toLocaleString(),k=z.level===0?"DEBUG":z.level===1?"INFO":z.level===2?"WARN":"ERROR";return`[${U}] [${k}] [${z.category}] ${z.message}`}).join(`
`);b.textContent=A}}onClose(){let{contentEl:w}=this;w.empty()}}(this.app).open():new I.Notice("\u274C LoggingService unavailable",5e3)})),new I.Setting(e).setName("\u0418\u043C\u043F\u043E\u0440\u0442 \u0432\u0441\u0435\u0445 \u0444\u0430\u0439\u043B\u043E\u0432").setDesc("\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u0430\u0442\u044C \u0432\u0441\u0435 ZIP-\u0444\u0430\u0439\u043B\u044B \u0432 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u0435\u043C\u043E\u0439 \u043F\u0430\u043F\u043A\u0435 \u043F\u0440\u044F\u043C\u043E \u0441\u0435\u0439\u0447\u0430\u0441").addButton(a=>a.setButtonText("\u0418\u043C\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0432\u0441\u0435").setClass("mod-warning").onClick(async()=>{let c=this.plugin;if(!c.settingsManager.getSetting("watchedFolderPath")){new I.Notice(`\u274C ${this.localization.t("notifications.error.watchingFailed",{error:"No watched folder specified"})}`,5e3);return}new I.Notice(`\u{1F504} ${this.localization.t("notifications.info.scanningFolder")}`,3e3);try{c.fileWatcher&&c.fileWatcher.scanExistingFiles?(await c.fileWatcher.scanExistingFiles(),new I.Notice("\u2705 Mass import completed successfully!",5e3)):new I.Notice("\u274C FileWatcherService unavailable",5e3)}catch(w){console.error("[Krisp Importer] Mass import error:",w),new I.Notice(`\u274C Mass import error: ${w.message}`,8e3)}})),new I.Setting(e).setName(this.localization.t("settings.buttons.testImport")).setDesc("Select ZIP file for test import with current settings").addButton(a=>a.setButtonText(this.localization.t("settings.buttons.testImport")).onClick(async()=>{let c=this.plugin,f=this.localization;new class extends I.Modal{constructor(S){super(S);this.result=""}onOpen(){let{contentEl:S}=this;S.createEl("h2",{text:f.t("modals.testImport.title")}),S.createEl("p",{text:f.t("modals.testImport.placeholder")});let E=S.createEl("input",{type:"text",placeholder:"/path/to/meeting.zip"});E.style.width="100%",E.style.marginBottom="10px";let y=S.createEl("div");y.style.display="flex",y.style.gap="10px",y.style.justifyContent="flex-end";let L=y.createEl("button",{text:f.t("modals.testImport.button")});L.className="mod-cta",L.onclick=async()=>{let F=E.value.trim();if(F){this.result=F,this.close();let b=c;if(b&&b.processingService)try{new I.Notice(`\u{1F9EA} ${f.t("notifications.info.processing",{file:"test file"})}`,3e3),await b.processingService.processZipFile(F),new I.Notice("\u2705 Test import completed successfully!",5e3)}catch(M){console.error("[Krisp Importer] Test import error:",M),new I.Notice(`\u274C Test import error: ${M.message}`,8e3)}else new I.Notice("\u274C ProcessingService unavailable",5e3)}};let x=y.createEl("button",{text:f.t("modals.confirmReset.cancel")});x.onclick=()=>this.close(),E.focus(),E.addEventListener("keypress",F=>{F.key==="Enter"&&L.click()})}onClose(){let{contentEl:S}=this;S.empty()}}(this.app).open()})),e.createEl("h2",{text:this.localization.t("settings.sections.templates")});let s=e.createEl("p",{text:this.localization.t("settings.fields.noteContentTemplate.desc")});s.style.fontSize="0.9em",s.style.color="var(--text-muted)",new I.Setting(e).setName(this.localization.t("settings.fields.noteContentTemplate.name")).setDesc("").addTextArea(a=>(a.inputEl.rows=10,a.inputEl.style.width="100%",a.inputEl.style.fontFamily="monospace",a.inputEl.style.fontSize="0.85em",a.setPlaceholder("Enter note template...").setValue(this.plugin.settingsManager.getSetting("noteContentTemplate")).onChange(async c=>{await this.plugin.settingsManager.updateSetting("noteContentTemplate",c)}))),new I.Setting(e).setName(this.localization.t("settings.buttons.restoreTemplate")).setDesc("Restore default note template").addButton(a=>a.setButtonText(this.localization.t("settings.buttons.restoreTemplate")).setCta().onClick(async()=>{await this.plugin.settingsManager.updateSetting("noteContentTemplate",$.noteContentTemplate),this.display()})),e.createEl("h2",{text:this.localization.t("settings.sections.advanced")}),new I.Setting(e).setName(this.localization.t("settings.buttons.resetSettings")).setDesc("Reset all plugin settings to default values").addButton(a=>a.setButtonText(this.localization.t("settings.buttons.resetSettings")).setClass("mod-warning").onClick(async()=>{let c=this.plugin,f=this.localization;new class extends I.Modal{constructor(v){super(v)}onOpen(){let{contentEl:v}=this;v.createEl("h2",{text:f.t("modals.confirmReset.title")}),v.createEl("p",{text:f.t("modals.confirmReset.message")});let S=v.createEl("div");S.style.display="flex",S.style.gap="10px",S.style.justifyContent="flex-end",S.style.marginTop="20px";let E=S.createEl("button",{text:f.t("modals.confirmReset.confirm")});E.className="mod-warning",E.onclick=async()=>{this.close();let L=c;if(L&&L.settingsManager)try{for(let[F,b]of Object.entries($))await L.settingsManager.updateSetting(F,b);new I.Notice(`\u2705 ${f.t("notifications.success.settingsReset")}`,5e3);let x=L.settingsTab;x&&x.display&&x.display()}catch(x){console.error("[Krisp Importer] Settings reset error:",x),new I.Notice(`\u274C Settings reset error: ${x.message}`,8e3)}else new I.Notice("\u274C Plugin unavailable for settings reset",5e3)};let y=S.createEl("button",{text:f.t("modals.confirmReset.cancel")});y.onclick=()=>this.close()}onClose(){let{contentEl:v}=this;v.empty()}}(this.app).open()})),e.createEl("h2",{text:this.localization.t("settings.info.title")});let i=e.createEl("div"),n=((l=this.plugin.manifest)==null?void 0:l.version)||"unknown";i.createEl("p",{text:`${this.localization.t("settings.info.version")}: v${n}`}),i.createEl("p",{text:`${this.localization.t("settings.info.status")}: ${this.localization.t("settings.info.features.0")}`}),this.localization.getSettingsStrings().info.features.forEach(a=>{i.createEl("p",{text:a})});let r=e.createEl("div");r.style.padding="15px",r.style.backgroundColor="var(--background-secondary)",r.style.borderRadius="8px",r.style.marginTop="15px",r.style.border="1px solid var(--background-modifier-border)",r.createEl("h4",{text:"\u{1F680} "+(this.localization.getCurrentLanguage()==="ru"?"\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0435 \u043A\u043E\u043C\u0430\u043D\u0434\u044B:":"Available commands:")}),this.localization.getSettingsStrings().info.commands.forEach(a=>{r.createEl("p",{text:`\u2022 ${a}`})});let p=e.createEl("div");p.style.padding="10px",p.style.backgroundColor="var(--background-primary-alt)",p.style.borderRadius="5px",p.style.marginTop="10px",p.style.borderLeft="4px solid var(--interactive-accent)",p.createEl("p",{text:"\u{1F4A1} \u0421\u043E\u0432\u0435\u0442: \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 \u043F\u0430\u043B\u0438\u0442\u0440\u0443 \u043A\u043E\u043C\u0430\u043D\u0434 (Ctrl/Cmd + P) \u0434\u043B\u044F \u0431\u044B\u0441\u0442\u0440\u043E\u0433\u043E \u0434\u043E\u0441\u0442\u0443\u043F\u0430 \u043A\u043E \u0432\u0441\u0435\u043C \u0444\u0443\u043D\u043A\u0446\u0438\u044F\u043C \u043F\u043B\u0430\u0433\u0438\u043D\u0430"})}};var G=require("obsidian");var Wt=st(Zt()),O=require("fs"),lt=require("obsidian"),at=st(require("path")),ft=class{constructor(t){this.app=t}async extract(t,e){try{let i=require("os").tmpdir(),n=at.join(i,"krisp-importer-temp",e+"_"+Date.now()),r=at.join(i,"krisp-importer-temp");(0,O.existsSync)(r)||(0,O.mkdirSync)(r,{recursive:!0}),(0,O.existsSync)(n)||(0,O.mkdirSync)(n,{recursive:!0});let p=new Wt.async({file:t});try{let l=await p.entries();for(let[a,c]of Object.entries(l))if(!c.isDirectory){let f=(0,lt.normalizePath)(at.join(n,a)),w=at.dirname(f);(0,O.existsSync)(w)||(0,O.mkdirSync)(w,{recursive:!0});let v=await p.entryData(a);await O.promises.writeFile(f,v)}return console.log(`Successfully extracted to ${n}`),n}finally{await p.close()}}catch(s){return new lt.Notice("Error extracting ZIP file: "+s.message),console.error("Error extracting ZIP file:",s),null}}async cleanup(t){if(t)try{(0,O.existsSync)(t)&&((0,O.rmSync)(t,{recursive:!0,force:!0}),console.log(`Successfully cleaned up temp directory: ${t}`))}catch(e){new lt.Notice("Error cleaning up temporary directory: "+e.message),console.error("Error cleaning up temporary directory:",e)}}};var St=class{constructor(){}parseMeetingNotes(t,e,s){var c;let i={},n=s;n=n.replace(/\s*\([0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}\)$/,""),n=n.replace(/-[0-9a-fA-F]{32}$/,""),n=n.replace(/\s*-\s*[A-Za-z]+(?:\s+|,\s*)[0-9]{1,2}(?:,\s*[0-9]{4})?(?:\s+[0-9]{1,2}[0-9]{2}(?:\s*(?:AM|PM))?)?$/,"").trim(),i.meetingTitle=n;let r=(c=t.split(`
`)[0])==null?void 0:c.trim(),p=null,l=null;if(r&&(p=this.extractDateFromString(r),l=this.extractTimeFromString(r)),p||(p=this.extractDateFromString(s)),!l&&(l=this.extractTimeFromString(s),l==="00:00"&&e)){let f=e.match(/(\d{2}:\d{2}(?::\d{2})?)/)}i.date=p||void 0,i.time=l||void 0,i.summary=this.extractSection(t,"Summary"),i.actionItems=this.extractSection(t,"Action Items",!0),i.keyPoints=this.extractSection(t,"Key Points",!0);let a=this.parseTranscript(e);return i.participants=a.participants,i.rawTranscript=e,i.formattedTranscript=a.formattedTranscript,i.duration=a.duration,i.participantsCount=a.participants.length,i.transcriptWords=this.countWords(e),i.mostActiveSpeaker=this.findMostActiveSpeaker(e),i.participantsStats=this.generateParticipantsStats(e,a.participants),i.extractedEntities=this.extractEntities(t,e),i.relatedLinks=this.generateRelatedLinks(t,n),i.importDate=new Date().toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i.smartTags=this.generateSmartTags(t,e,n),i.tags=[...i.smartTags||[]],i}parseTranscript(t){let e=t.split(`
`),s=new Set,i=[],n="00:00:00",r=/^(.+?)\s*\|\s*(\d{2}:\d{2}(?::\d{2})?)$/;for(let l=0;l<e.length;l++){let c=e[l].trim();if(c==="")continue;let f=c.match(r);if(f){let w=f[1].trim(),v=f[2];w&&!w.toLowerCase().includes("transcription service")&&!w.toLowerCase().includes("meeting summary")&&s.add(w);let S=v.length===5?`${v}:00`:v;n=S;let E=[],y=l+1;for(;y<e.length;){let L=e[y].trim();if(L===""){y++;continue}if(r.test(L))break;L.toLowerCase()==="\u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0435\u043D\u0438\u0435 \u0441\u043B\u0435\u0434\u0443\u0435\u0442..."?E.push(`_${L}_`):E.push(L),y++}if(E.length>0){let L=E.join(`
`);i.push(`[[${S}]] **${w}**: ${L}`)}else i.push(`[[${S}]] **${w}**:`);l=y-1}else c.toLowerCase()==="\u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0435\u043D\u0438\u0435 \u0441\u043B\u0435\u0434\u0443\u0435\u0442..."?i.push(`_${c}_`):i.length>0?i[i.length-1]+=`
${c}`:i.push(c)}let p="N/A";return n!=="00:00:00"&&(p=n),{participants:Array.from(s),formattedTranscript:i.join(`

`),duration:p}}extractDateFromString(t){if(!t)return null;let e,s,i,n=t.match(/(\d{4})-(\d{2})-(\d{2})/);if(n&&(e=parseInt(n[1],10),s=parseInt(n[2],10),i=parseInt(n[3],10),s>=1&&s<=12&&i>=1&&i<=31))return`${String(e).padStart(4,"0")}-${String(s).padStart(2,"0")}-${String(i).padStart(2,"0")}`;if(n=t.match(/([A-Za-z]+)\s+(\d{1,2}),\s+(\d{4})/),n){let r=n[1];if(i=parseInt(n[2],10),e=parseInt(n[3],10),s=this.monthNameToNumber(r),s&&i>=1&&i<=31)return`${String(e).padStart(4,"0")}-${String(s).padStart(2,"0")}-${String(i).padStart(2,"0")}`}if(n=t.match(/([A-Za-z]+),\s*(\d{1,2})(?!\s*,\s*\d{4})/),n){let r=n[1];if(i=parseInt(n[2],10),e=new Date().getFullYear(),s=this.monthNameToNumber(r),s&&i>=1&&i<=31)return`${String(e).padStart(4,"0")}-${String(s).padStart(2,"0")}-${String(i).padStart(2,"0")}`}if(n=t.match(/(\d{1,2})\s+([A-Za-z]+)\s+(\d{4})/),n){i=parseInt(n[1],10);let r=n[2];if(e=parseInt(n[3],10),s=this.monthNameToNumber(r),s&&i>=1&&i<=31)return`${String(e).padStart(4,"0")}-${String(s).padStart(2,"0")}-${String(i).padStart(2,"0")}`}return null}extractTimeFromString(t){if(!t)return null;let e=t.match(/(\d{2}):(\d{2})(?!\s*(?:AM|PM))/);if(e){let s=parseInt(e[1],10),i=parseInt(e[2],10);if(s>=0&&s<=23&&i>=0&&i<=59)return`${String(s).padStart(2,"0")}:${String(i).padStart(2,"0")}`}if(e=t.match(/(\d{1,2}):(\d{2})\s*(AM|PM)/i),e){let s=parseInt(e[1],10),i=parseInt(e[2],10),n=e[3].toUpperCase();if(s>=1&&s<=12&&i>=0&&i<=59)return n==="PM"&&s!==12?s+=12:n==="AM"&&s===12&&(s=0),`${String(s).padStart(2,"0")}:${String(i).padStart(2,"0")}`}return"00:00"}extractSection(t,e,s=!1){var c,f;let i=t.split(`
`),n=[],r=!1,p=new RegExp(`^${e}s*$`,"i"),l=["Summary","Action Items","Key Points","Transcript","Transcription"],a=new RegExp(`^(${l.filter(w=>w.toLowerCase()!==e.toLowerCase()).join("|")})s*$`,"i");for(let w=0;w<i.length;w++){let v=i[w];if(p.test(v)){r=!0;continue}if(r){if(a.test(v))break;let S=v.trim();if(S===""){if(s){let E=(c=i[w+1])==null?void 0:c.trim();if(!(E&&!E.match(/^(\s*[-*]|[0-9]+\.)/)&&!E.match(/^\s+/))){if(!E)break}}else if(((f=i[w+1])==null?void 0:f.trim())==="")break}if(S!==""||s&&n.length>0)if(s){let E=S;(E.startsWith("- ")||E.startsWith("* "))&&(E=E.substring(2).trim()),(e==="Action Items"&&E||E)&&n.push(E)}else n.push(S);else n.length>0}}return n}escapeRegExp(t){return t.replace(/[.*+?^${}()|[\\\]]/g,"\\$&")}isLikelyDateOrTime(t){if(!t)return!1;let e=/^(\d{4}-\d{2}-\d{2}|[A-Za-z]+\s+\d{1,2}(?:,\s*\d{4})?)$/i,s=/^(\d{1,2}:\d{2}(\s*[APap][Mm])?)$/;return e.test(t)||s.test(t)}isSectionHeader(t){if(!t)return!1;let e=t.toLowerCase();return e.startsWith("summary")||e.startsWith("action items")||e.startsWith("key points")||e.startsWith("transcript")}monthNameToNumber(t){if(!t)return null;let e=t.toLowerCase().substring(0,3);return{jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12,\u044F\u043D\u0432:1,\u0444\u0435\u0432:2,\u043C\u0430\u0440:3,\u0430\u043F\u0440:4,\u043C\u0430\u044F:5,\u0438\u044E\u043D:6,\u0438\u044E\u043B:7,\u0430\u0432\u0433:8,\u0441\u0435\u043D:9,\u043E\u043A\u0442:10,\u043D\u043E\u044F:11,\u0434\u0435\u043A:12}[e]||null}countWords(t){return t?t.trim().split(/\s+/).filter(e=>e.length>0).length:0}findMostActiveSpeaker(t){let e=t.split(`
`),s={},i="";for(let p of e){let l=p.trim();if(l==="")continue;let a=l.match(/^(.+?)\s*\|\s*(\d{2}:\d{2}(?::\d{2})?)$/);if(a)i=a[1].trim(),s[i]||(s[i]=0);else if(i){let c=this.countWords(l);s[i]+=c}}let n="",r=0;for(let[p,l]of Object.entries(s))l>r&&(r=l,n=p);return n||"N/A"}generateParticipantsStats(t,e){let s=t.split(`
`),i={},n={},r="";for(let a of e)i[a]=0,n[a]=0;for(let a of s){let c=a.trim();if(c==="")continue;let f=c.match(/^(.+?)\s*\|\s*(\d{2}:\d{2}(?::\d{2})?)$/);if(f)r=f[1].trim(),n[r]!==void 0&&n[r]++;else if(r&&i[r]!==void 0){let w=this.countWords(c);i[r]+=w}}let p=[],l=Object.values(i).reduce((a,c)=>a+c,0);for(let a of e){let c=i[a]||0,f=n[a]||0,w=l>0?(c/l*100).toFixed(1):"0";p.push(`- **${a}**: ${c} \u0441\u043B\u043E\u0432 (${w}%), ${f} \u0432\u044B\u0441\u0442\u0443\u043F\u043B\u0435\u043D\u0438\u0439`)}return p.length>0?["### \u{1F4CA} \u0410\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u044C \u0443\u0447\u0430\u0441\u0442\u043D\u0438\u043A\u043E\u0432","",...p]:[]}extractEntities(t,e){let s=[],n=`${t} ${e}`.substring(0,5e3),r={projects:/(?:|project|||||)\s+([--\w\s]{3,30})/gi,companies:/(?:|||||)\s+([--\w\s]{3,30})|([--][--\w]*(?:||||))/gi,dates:/\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4}|\d{4}[\.\-\/]\d{1,2}[\.\-\/]\d{1,2}/g},p=n.match(r.projects);p&&p.length>0&&(s.push("### \u{1F680} \u0423\u043F\u043E\u043C\u044F\u043D\u0443\u0442\u044B\u0435 \u043F\u0440\u043E\u0435\u043A\u0442\u044B",""),[...new Set(p.slice(0,5))].forEach(f=>s.push(`- ${f.trim()}`)),s.push(""));let l=n.match(r.companies);l&&l.length>0&&(s.push("### \u{1F3E2} \u0423\u043F\u043E\u043C\u044F\u043D\u0443\u0442\u044B\u0435 \u043A\u043E\u043C\u043F\u0430\u043D\u0438\u0438",""),[...new Set(l.slice(0,5))].forEach(f=>s.push(`- ${f.trim()}`)),s.push(""));let a=n.match(r.dates);return a&&a.length>0&&(s.push("### \u{1F4C5} \u0423\u043F\u043E\u043C\u044F\u043D\u0443\u0442\u044B\u0435 \u0434\u0430\u0442\u044B",""),[...new Set(a.slice(0,5))].forEach(f=>s.push(`- ${f}`)),s.push("")),s}generateRelatedLinks(t,e){let s=[],i=t.match(/|||/gi);i&&i.length>1&&s.push("- \u{1F4CB} **\u0421\u0432\u044F\u0437\u0430\u043D\u043D\u044B\u0435 \u0432\u0441\u0442\u0440\u0435\u0447\u0438:** [[\u041F\u043E\u0438\u0441\u043A \u0432\u0441\u0442\u0440\u0435\u0447]]");let n=t.match(/||||/gi);return n&&n.length>0&&s.push("- \u{1F4C4} **\u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u044B:** [[\u041F\u043E\u0438\u0441\u043A \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u043E\u0432]]"),e.toLowerCase().includes("\u043F\u0440\u043E\u0435\u043A\u0442")&&s.push("- \u{1F680} **\u041F\u0440\u043E\u0435\u043A\u0442:** [[\u041F\u0440\u043E\u0435\u043A\u0442\u044B]]"),s}generateSmartTags(t,e,s){let i=new Set,n=`${t} ${e} ${s}`.toLowerCase();i.add("meeting"),i.add("krisp");let r={\u043F\u0440\u043E\u0435\u043A\u0442:"project",project:"project",\u043F\u043B\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435:"planning",planning:"planning",\u0440\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u043A\u0430:"development",development:"development",\u043E\u0431\u0441\u0443\u0436\u0434\u0435\u043D\u0438\u0435:"discussion",\u0432\u0441\u0442\u0440\u0435\u0447\u0430:"meeting",\u0430\u043D\u0430\u043B\u0438\u0437:"analysis",strategy:"strategy",\u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044F:"strategy",\u0432\u043D\u0435\u0434\u0440\u0435\u043D\u0438\u0435:"implementation",\u0442\u0435\u0441\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435:"testing",\u0440\u0435\u0432\u044C\u044E:"review",review:"review",\u0431\u044E\u0434\u0436\u0435\u0442:"budget",budget:"budget",deadline:"deadline",\u0434\u0435\u0434\u043B\u0430\u0439\u043D:"deadline",hr:"hr",\u0440\u0435\u043A\u0440\u0443\u0442\u0438\u043D\u0433:"hr",recruiting:"hr",\u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F:"integration",integration:"integration",api:"technical",\u0441\u0438\u0441\u0442\u0435\u043C\u0430:"system",system:"system",\u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u044C:"security",security:"security",\u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0430:"support",support:"support"};for(let[p,l]of Object.entries(r))n.includes(p)&&i.add(l);return(n.includes("ceo")||n.includes("director")||n.includes("\u0434\u0438\u0440\u0435\u043A\u0442\u043E\u0440"))&&i.add("management"),(n.includes("developer")||n.includes("\u0440\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A")||n.includes("\u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0441\u0442"))&&i.add("technical"),(n.includes("designer")||n.includes("\u0434\u0438\u0437\u0430\u0439\u043D\u0435\u0440"))&&i.add("design"),(n.includes("\u0440\u0435\u0442\u0440\u043E\u0441\u043F\u0435\u043A\u0442\u0438\u0432\u0430")||n.includes("retrospective"))&&i.add("retrospective"),(n.includes("\u043F\u043B\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435")||n.includes("planning"))&&i.add("planning"),(n.includes("\u0434\u0435\u043C\u043E")||n.includes("demo")||n.includes("\u043F\u0440\u0435\u0437\u0435\u043D\u0442\u0430\u0446\u0438\u044F"))&&i.add("demo"),Array.from(i)}};var K=require("obsidian"),H=st(require("path")),Et=class{constructor(t,e){this.app=t,this.vault=t.vault,this.settings=e}formatSummaryForCallout(t){if(!t||t.length===0)return"*\u041A\u0440\u0430\u0442\u043A\u043E\u0435 \u0441\u043E\u0434\u0435\u0440\u0436\u0430\u043D\u0438\u0435 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u043D\u043E*";let e=[],s=0,i=!1;for(let n=0;n<t.length;n++){let p=t[n].trim();if(p===""){e.push(""),i=!1;continue}if(s===0&&p.toLowerCase()==="summary")continue;if(/^[-*]\s+/.test(p)){let a=p.replace(/^[-*]\s+/,"");e.push(`- ${a}`),i=!0}else i?e.push(`  ${p}`):(i=!1,s++,s>1&&e.push(""),e.push(`### ${s}. ${p}`),e.push(""))}return e.map(n=>n===""?">":`> ${n}`).join(`
`)}applyTemplate(t,e,s,i,n){var x,F,b,M,A,z,U,k;let r=t;r=r.replace(/{{meetingTitle}}/g,e.meetingTitle||"Untitled Meeting"),r=r.replace(/{{title}}/g,e.meetingTitle||"Untitled Meeting"),r=r.replace(/{{date}}/g,e.date||"YYYY-MM-DD"),r=r.replace(/{{time}}/g,e.time||"HH:MM"),r=r.replace(/{{duration}}/g,e.duration||"N/A");let p=((x=e.participants)==null?void 0:x.map(D=>`- **${D}**`).join(`
`))||"- *\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043E \u0443\u0447\u0430\u0441\u0442\u043D\u0438\u043A\u0430\u0445 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u043D\u0430*";r=r.replace(/{{participantsList}}/g,p),r=r.replace(/{{participants}}/g,((F=e.participants)==null?void 0:F.join(", "))||"N/A"),r=r.replace(/{{participantsCount}}/g,String(e.participantsCount||0)),r=r.replace(/{{transcriptWords}}/g,String(e.transcriptWords||0)),r=r.replace(/{{mostActiveSpeaker}}/g,e.mostActiveSpeaker||"N/A"),r=r.replace(/{{importDate}}/g,e.importDate||new Date().toLocaleDateString("ru-RU"));let l=((b=e.participantsStats)==null?void 0:b.join(`
`))||"*\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u043D\u0430*";r=r.replace(/{{participantsStats}}/g,l);let a=(M=e.extractedEntities)!=null&&M.length?e.extractedEntities.join(`

`):"*\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430*";r=r.replace(/{{extractedEntities}}/g,a);let c=(A=e.relatedLinks)!=null&&A.length?`
`+e.relatedLinks.join(`
`):"";r=r.replace(/{{relatedLinks}}/g,c);let f=(z=e.summary)!=null&&z.length?this.formatSummaryForCallout(e.summary):"*\u041A\u0440\u0430\u0442\u043A\u043E\u0435 \u0441\u043E\u0434\u0435\u0440\u0436\u0430\u043D\u0438\u0435 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u043D\u043E*";r=r.replace(/{{summary}}/g,f);let w=((U=e.actionItems)==null?void 0:U.map(D=>`- [ ] ${D}`).join(`
> 
> `))||"*\u041D\u0435\u0442 \u0437\u0430\u0434\u0430\u0447 \u0434\u043B\u044F \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F*";r=r.replace(/{{actionItemsList}}/g,w),r=r.replace(/{{actionItems}}/g,w);let v=((k=e.keyPoints)==null?void 0:k.map(D=>`- ${D}`).join(`
> 
> `))||"*\u041A\u043B\u044E\u0447\u0435\u0432\u044B\u0435 \u043C\u043E\u043C\u0435\u043D\u0442\u044B \u043D\u0435 \u0432\u044B\u0434\u0435\u043B\u0435\u043D\u044B*";r=r.replace(/{{keyPointsList}}/g,v),r=r.replace(/{{keyPoints}}/g,v);let S=e.formattedTranscript?e.formattedTranscript.split(`
`).map(D=>`> ${D}`).join(`
`):"> *\u0422\u0440\u0430\u043D\u0441\u043A\u0440\u0438\u043F\u0442 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D*";r=r.replace(/{{formattedTranscript}}/g,S),r=r.replace(/{{transcript}}/g,S),r=r.replace(/{{rawTranscript}}/g,e.rawTranscript||"\u0421\u044B\u0440\u043E\u0439 \u0442\u0440\u0430\u043D\u0441\u043A\u0440\u0438\u043F\u0442 \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D");let E=[...e.tags||[],...e.smartTags||[]],y=[...new Set(E)],L=y.length>0?y.map(D=>`  - ${D}`).join(`
`)+`
`:"";if(r=r.replace(/{{yamlTags}}/g,L),n){let D=(0,K.normalizePath)(n);r=r.replace(/{{audioPathForYaml}}/g,D),r=r.replace(/{{audioLink}}/g,D),r=r.replace(/{{audioEmbed}}/g,`![[${D}]]`)}else r=r.replace(/{{audioPathForYaml}}/g,""),r=r.replace(/{{audioLink}}/g,"N/A"),r=r.replace(/{{audioEmbed}}/g,`> [!warning] \u0410\u0443\u0434\u0438\u043E\u0444\u0430\u0439\u043B \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D
> \u0410\u0443\u0434\u0438\u043E\u0444\u0430\u0439\u043B \u043D\u0435 \u0431\u044B\u043B \u0438\u043C\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D \u0438\u043B\u0438 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D \u0432 \u0430\u0440\u0445\u0438\u0432\u0435.`);return i?r=r.replace(/{{noteFileName}}/g,i.replace(/\.md$/,"")):r=r.replace(/{{noteFileName}}/g,e.meetingTitle||"Untitled Meeting"),r=r.replace(/{{YYYY}}/g,e.date?e.date.substring(0,4):"YYYY"),r=r.replace(/{{MM}}/g,e.date?e.date.substring(5,7):"MM"),r=r.replace(/{{DD}}/g,e.date?e.date.substring(8,10):"DD"),r=r.replace(/{{HH}}/g,e.time?e.time.substring(0,2):"HH"),r=r.replace(/{{mm}}/g,e.time?e.time.substring(3,5):"mm"),r=r.replace(/{{HHMM}}/g,e.time?e.time.replace(":",""):"HHMM"),r}generateFileName(t,e,s){var n,r,p,l,a,c;let i=t;return i=i.replace(/{{YYYY}}/g,((n=e.date)==null?void 0:n.substring(0,4))||"YYYY"),i=i.replace(/{{MM}}/g,((r=e.date)==null?void 0:r.substring(5,7))||"MM"),i=i.replace(/{{DD}}/g,((p=e.date)==null?void 0:p.substring(8,10))||"DD"),i=i.replace(/{{HHMM}}/g,((l=e.time)==null?void 0:l.replace(":",""))||"HHMM"),i=i.replace(/{{HH}}/g,((a=e.time)==null?void 0:a.substring(0,2))||"HH"),i=i.replace(/{{mm}}/g,((c=e.time)==null?void 0:c.substring(3,5))||"mm"),i=i.replace(/{{meetingTitle}}/g,e.meetingTitle||"Untitled Meeting"),i=i.replace(/[\/:\[\]\*\?"<>\|#^]/g,"_").replace(/\s+/g,"_"),`${i}.${s}`}async createNote(t,e){var w,v,S;let s=this.generateFileName(this.settings.noteNameTemplate,t,"md"),i=((w=t.date)==null?void 0:w.substring(0,4))||"YYYY",n=((v=t.date)==null?void 0:v.substring(5,7))||"MM",r=(0,K.normalizePath)(H.join(this.settings.notesFolderPath,i,n));await this.ensureFolderExists(r);let p=(0,K.normalizePath)(H.join(r,s)),l=this.vault.getAbstractFileByPath(p);if(l&&l instanceof K.TFile)switch(this.settings.duplicateStrategy){case"skip":return console.log(`Note ${p} already exists. Skipping.`),new Notification("Krisp Importer",{body:`\u0417\u0430\u043C\u0435\u0442\u043A\u0430 ${s} \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442. \u0418\u043C\u043F\u043E\u0440\u0442 \u043F\u0440\u043E\u043F\u0443\u0449\u0435\u043D.`}),{notePath:p,noteFile:l};case"overwrite":console.log(`Note ${p} already exists. Overwriting.`),await this.vault.delete(l);break;case"rename":let E=1,y=s.substring(0,s.lastIndexOf(".")),L=s.substring(s.lastIndexOf(".")+1);for(;l;)p=(0,K.normalizePath)(H.join(r,`${y}_${E}.${L}`)),l=this.vault.getAbstractFileByPath(p),E++;console.log(`Note ${p} will be created with a new name.`);break}let a;if(e&&t.meetingTitle){let E=H.extname(e)||".mp3",y=this.generateFileName(this.settings.attachmentNameTemplate,t,E.substring(1)),L=this.settings.attachmentsFolderPath;!L.includes("{{YYYY}}")&&!L.includes("{{MM}}")&&(L=H.join(L,i,n)),L=L.replace(/{{YYYY}}/g,i).replace(/{{MM}}/g,n).replace(/{{DD}}/g,((S=t.date)==null?void 0:S.substring(8,10))||"DD"),await this.ensureFolderExists((0,K.normalizePath)(L)),a=(0,K.normalizePath)(H.join(L,y));let x=this.vault.getAbstractFileByPath(a);if(x){let F=1,b=y.substring(0,y.lastIndexOf(".")),M=y.substring(y.lastIndexOf(".")+1);for(;x;)a=(0,K.normalizePath)(H.join(L,`${b}_${F}.${M}`)),x=this.vault.getAbstractFileByPath(a),F++}}let c=this.applyTemplate(this.settings.noteContentTemplate,t,this.settings,p.split("/").pop(),a),f=await this.vault.create(p,c);return console.log(`Note created: ${p}`),{notePath:p,audioDestPath:a,noteFile:f}}async ensureFolderExists(t){let e=(0,K.normalizePath)(t);if(e==="/"||e==="")return;if(!this.vault.getAbstractFileByPath(e)){let i=e.split("/"),n="";for(let r of i){if(!r)continue;if(n=n?`${n}/${r}`:r,!this.vault.getAbstractFileByPath(n))try{await this.vault.createFolder(n)}catch(l){if(!this.vault.getAbstractFileByPath(n))throw console.error(`Failed to create folder ${n}:`,l),l}}}}};var gt=require("obsidian"),ot=class{constructor(){}showSuccess(t,e=5e3){new gt.Notice(t,e),console.log(`[Krisp Importer] SUCCESS: ${t}`)}showError(t,e=8e3){new gt.Notice(`ERROR: ${t}`,e),console.error(`[Krisp Importer] ERROR: ${t}`)}showWarning(t,e=6e3){new gt.Notice(`WARNING: ${t}`,e),console.warn(`[Krisp Importer] WARNING: ${t}`)}showInfo(t,e=4e3){new gt.Notice(t,e),console.log(`[Krisp Importer] INFO: ${t}`)}showDuplicateFound(t,e,s){let i=`\u0414\u0443\u0431\u043B\u0438\u043A\u0430\u0442 "${t}": ${s} (\u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044F: ${e})`;this.showWarning(i)}showBatchImportResult(t,e,s,i){t>0&&e===0?this.showSuccess(`\u0418\u043C\u043F\u043E\u0440\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D: ${t} \u0432\u0441\u0442\u0440\u0435\u0447(\u0438) \u0438\u0437 "${i}"`,8e3):t>0&&e>0?this.showWarning(`\u0418\u043C\u043F\u043E\u0440\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D \u0447\u0430\u0441\u0442\u0438\u0447\u043D\u043E: ${t} \u0443\u0441\u043F\u0435\u0448\u043D\u043E, ${e} \u043E\u0448\u0438\u0431\u043E\u043A \u0438\u0437 "${i}"`,1e4):e>0?this.showError(`\u0418\u043C\u043F\u043E\u0440\u0442 \u043D\u0435 \u0443\u0434\u0430\u043B\u0441\u044F: ${e} \u043E\u0448\u0438\u0431\u043E\u043A \u0432 "${i}"`,1e4):this.showInfo(`\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445 \u0434\u043B\u044F \u0438\u043C\u043F\u043E\u0440\u0442\u0430 \u0432 "${i}"`,6e3),s>0&&this.showInfo(`\u041F\u0440\u043E\u043F\u0443\u0449\u0435\u043D\u043E \u0434\u0443\u0431\u043B\u0438\u043A\u0430\u0442\u043E\u0432: ${s}`,4e3)}};var tt=st(require("path")),j=require("fs"),wt=class{constructor(t,e){this.app=t,this.zipExtractor=new ft(this.app),this.noteParser=new St,this.noteCreator=null,this.notificationService=new ot,this.statusBarService=e||null}async processZipFile(t,e){var r,p,l;let s=null,i=tt.basename(t),n=new G.Notice(`Processing ${i}...`,0);this.statusBarService&&this.statusBarService.setProcessing(i),this.noteCreator=new Et(this.app,e);try{let a=`${i.replace(".zip","")}_${Date.now()}`;if(s=await this.zipExtractor.extract(t,a),!s){this.notificationService.showError(`Failed to extract ZIP file: ${i}`),n&&n.hide();return}let f=(await j.promises.readdir(s,{withFileTypes:!0})).filter(S=>S.isDirectory());if(f.length===0){this.notificationService.showError(`No meeting folders found in ZIP: ${i}`),n&&n.hide(),await this.zipExtractor.cleanup(s);return}let w=0,v=0;for(let S of f){let E=S.name,y=(0,G.normalizePath)(tt.join(s,E));new G.Notice(`Processing meeting: ${E}...`);let L="meeting_notes.txt",x="transcript.txt",F="recording.mp3",b=(0,G.normalizePath)(tt.join(y,L)),M=(0,G.normalizePath)(tt.join(y,x)),A=await j.promises.readdir(y),U=A.find(h=>h.toLowerCase().startsWith("recording.")&&(h.toLowerCase().endsWith(".mp3")||h.toLowerCase().endsWith(".m4a")))||F,k=(0,G.normalizePath)(tt.join(y,U)),D="",it="";try{D=await j.promises.readFile(b,"utf-8")}catch(h){this.notificationService.showError(`Failed to read ${L} from ${E} in ${i}`);let m=A.find(u=>u.toLowerCase().includes("notes")&&u.toLowerCase().endsWith(".txt")&&u!==L);if(m){this.notificationService.showInfo(`Attempting to use alternative notes file: ${m}`);try{D=await j.promises.readFile(tt.join(y,m),"utf-8")}catch(u){this.notificationService.showError(`Failed to read alternative notes file ${m} for ${E}.`),v++;continue}}else{v++;continue}}try{it=await j.promises.readFile(M,"utf-8")}catch(h){this.notificationService.showWarning(`Failed to read ${x} for ${E} in ${i}. Transcript might be missing.`)}let W=this.noteParser.parseMeetingNotes(D,it,E);console.log(`[DEBUG] Parsed data for ${E}:`,{title:W.meetingTitle,date:W.date,time:W.time,participants:W.participants,hasTranscript:!!W.formattedTranscript,transcriptLength:((r=W.formattedTranscript)==null?void 0:r.length)||0,summaryLength:((p=W.summary)==null?void 0:p.length)||0,actionItemsLength:((l=W.actionItems)==null?void 0:l.length)||0});let o=await this.noteCreator.createNote(W,k);if(!o.notePath){this.notificationService.showError(`Failed to create note for ${E}`),v++;continue}console.log(`[DEBUG] Note created at: ${o.notePath}, audio dest: ${o.audioDestPath}`);try{await j.promises.access(k),console.log(`[DEBUG] Audio file found: ${k}`);let h=await j.promises.readFile(k);if(console.log(`[DEBUG] Audio file read, size: ${h.length} bytes`),o.audioDestPath){let m=this.app.vault.getAbstractFileByPath(o.audioDestPath);m&&m instanceof G.TFile?(this.notificationService.showInfo(`Overwriting existing audio file: ${o.audioDestPath}`),await this.app.vault.modifyBinary(m,h)):await this.app.vault.createBinary(o.audioDestPath,h),console.log(`[DEBUG] Audio file saved to: ${o.audioDestPath}`),this.notificationService.showInfo(`Audio file for ${E} saved: ${o.audioDestPath}`)}}catch(h){console.log("[DEBUG] Audio file error:",h),this.notificationService.showWarning(`Audio file ${U} not found in ${y}. Skipped audio.`)}this.notificationService.showSuccess(`Successfully imported meeting ${E} to ${o.notePath}`),w++}if(n&&n.hide(),this.statusBarService&&(v===0&&w>0?this.statusBarService.showTemporaryMessage(`\u0418\u043C\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u043E: ${w}`,3e3):v>0&&this.statusBarService.setError(`\u041E\u0448\u0438\u0431\u043E\u043A: ${v}`)),this.notificationService.showBatchImportResult(w,v,0,i),console.log(`[DEBUG] deleteZipAfterImport setting: ${e.deleteZipAfterImport}`),console.log(`[DEBUG] errorCount: ${v}, importedCount: ${w}`),e.deleteZipAfterImport&&v===0&&w>0)try{console.log(`[DEBUG] Attempting to delete ZIP file: ${t}`),await j.promises.rm(t),this.notificationService.showInfo(`Deleted original ZIP file: ${i}`),console.log(`[DEBUG] Successfully deleted ZIP file: ${t}`)}catch(S){console.error("[DEBUG] Failed to delete ZIP file:",S),this.notificationService.showError(`Failed to delete original ZIP file ${i}: ${S.message}`)}else e.deleteZipAfterImport?console.log(`[DEBUG] ZIP file not deleted due to errors or no imports. errorCount: ${v}, importedCount: ${w}`):console.log("[DEBUG] ZIP file deletion disabled in settings")}catch(a){n&&n.hide(),this.statusBarService&&this.statusBarService.setError(`\u041E\u0448\u0438\u0431\u043A\u0430: ${a.message}`),console.error("Error processing ZIP file:",a),this.notificationService.showError(`An unexpected error occurred while processing ${i}: ${a.message}`)}finally{s&&await this.zipExtractor.cleanup(s)}}};var Z=st(require("fs")),pt=st(require("path")),vt=class{constructor(t,e,s,i,n){this.watcher=null;this.isWatching=!1;this.watchedPath="";this.app=t,this.processingService=e,this.notificationService=s,this.settingsProvider=i,this.statusBarService=n||null}async startWatching(t){if(this.isWatching&&await this.stopWatching(),!t||t.trim()===""){this.notificationService.showError("No watched folder specified");return}try{if(!Z.existsSync(t)){this.notificationService.showError(`Folder does not exist: ${t}`);return}if(!Z.statSync(t).isDirectory()){this.notificationService.showError(`\u0423\u043A\u0430\u0437\u0430\u043D\u043D\u044B\u0439 \u043F\u0443\u0442\u044C \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043F\u0430\u043F\u043A\u043E\u0439: ${t}`);return}this.watchedPath=t,this.watcher=Z.watch(t,{persistent:!0},(s,i)=>{console.log(`[FileWatcher] Event detected: ${s}, filename: ${i}`),s==="rename"&&i&&this.handleFileEvent(i)}),this.isWatching=!0,this.statusBarService&&this.statusBarService.setWatching(t),this.notificationService.showSuccess(`\u041E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438 \u0437\u0430\u043F\u0443\u0449\u0435\u043D\u043E: ${t}`),console.log(`[Krisp Importer] FileWatcher started for: ${t}`)}catch(e){this.statusBarService&&this.statusBarService.setError(`\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u044F: ${e.message}`),console.error("[Krisp Importer] Error starting file watcher:",e),this.notificationService.showError(`\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u043F\u0443\u0441\u043A\u0430 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u044F: ${e.message}`)}}async stopWatching(){this.watcher&&(this.watcher.close(),this.watcher=null),this.isWatching&&(this.isWatching=!1,this.statusBarService&&this.statusBarService.setIdle("\u041E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E"),this.notificationService.showInfo("\u041E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E"),console.log("[Krisp Importer] FileWatcher stopped"))}isCurrentlyWatching(){return this.isWatching}getWatchedPath(){return this.watchedPath}async handleFileEvent(t){console.log(`[FileWatcher] Processing file event for: ${t}`);try{if(!t.toLowerCase().endsWith(".zip")){console.log(`[FileWatcher] Ignoring non-ZIP file: ${t}`);return}let e=pt.join(this.watchedPath,t);if(!Z.existsSync(e)||!Z.statSync(e).isFile())return;console.log(`[Krisp Importer] New ZIP file detected: ${t}`),await this.waitForFileStability(e);let i=this.settingsProvider();await this.processNewZipFile(e,i)}catch(e){console.error("[Krisp Importer] Error handling file event:",e),this.notificationService.showError(`\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 \u0444\u0430\u0439\u043B\u0430 ${t}: ${e.message}`)}}async waitForFileStability(t,e=5e3){let i=0,n=0,r=3;return new Promise(p=>{let l=()=>{try{if(!Z.existsSync(t)){p();return}let f=Z.statSync(t).size;if(f===i&&f>0){if(n++,n>=r){p();return}}else n=0;i=f,Date.now()-a<e?setTimeout(l,500):p()}catch(c){p()}},a=Date.now();l()})}async processNewZipFile(t,e){try{console.log(`[FileWatcher] Processing new ZIP file: ${t}`),console.log(`[FileWatcher] Settings - deleteZipAfterImport: ${e.deleteZipAfterImport}`),this.notificationService.showInfo(`\u041E\u0431\u043D\u0430\u0440\u0443\u0436\u0435\u043D \u043D\u043E\u0432\u044B\u0439 \u0444\u0430\u0439\u043B: ${pt.basename(t)}`),await this.processingService.processZipFile(t,e)}catch(s){console.error("[Krisp Importer] Error processing new ZIP file:",s),this.notificationService.showError(`\u041E\u0448\u0438\u0431\u043A\u0430 \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u043E\u0439 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 \u0444\u0430\u0439\u043B\u0430: ${s.message}`)}}async scanExistingFiles(){if(!(!this.isWatching||!this.watchedPath))try{let e=Z.readdirSync(this.watchedPath).filter(n=>n.toLowerCase().endsWith(".zip"));if(e.length===0){this.notificationService.showInfo("\u0412 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u0435\u043C\u043E\u0439 \u043F\u0430\u043F\u043A\u0435 \u043D\u0435\u0442 ZIP-\u0444\u0430\u0439\u043B\u043E\u0432");return}this.notificationService.showInfo(`\u041D\u0430\u0439\u0434\u0435\u043D\u043E ${e.length} ZIP-\u0444\u0430\u0439\u043B\u043E\u0432 \u0434\u043B\u044F \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438`);let s=0,i=0;for(let n of e)try{let r=pt.join(this.watchedPath,n),p=this.settingsProvider();await this.processNewZipFile(r,p),s++}catch(r){console.error(`[Krisp Importer] Error processing ${n}:`,r),i++}this.notificationService.showBatchImportResult(s,i,0,"\u043C\u0430\u0441\u0441\u043E\u0432\u043E\u0435 \u0441\u043A\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435")}catch(t){console.error("[Krisp Importer] Error scanning existing files:",t),this.notificationService.showError(`\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043A\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u043F\u0430\u043F\u043A\u0438: ${t.message}`)}}};var Ft=require("obsidian"),et=(i=>(i[i.DEBUG=0]="DEBUG",i[i.INFO=1]="INFO",i[i.WARN=2]="WARN",i[i.ERROR=3]="ERROR",i))(et||{}),It=class{constructor(t=1){this.logs=[];this.maxLogEntries=1e3;this.currentLogLevel=1;this.currentLogLevel=t,this.log(1,"System","LoggingService initialized")}log(t,e,s,i){if(t<this.currentLogLevel)return;let n={timestamp:new Date,level:t,category:e,message:s,details:i};this.logs.push(n),this.logs.length>this.maxLogEntries&&(this.logs=this.logs.slice(-this.maxLogEntries));let r=et[t],l=`[${n.timestamp.toISOString()}] [${r}] [${e}] ${s}`;switch(t){case 0:console.debug(l,i);break;case 1:console.info(l,i);break;case 2:console.warn(l,i);break;case 3:console.error(l,i);break}}debug(t,e,s){this.log(0,t,e,s)}info(t,e,s){this.log(1,t,e,s)}warn(t,e,s){this.log(2,t,e,s)}error(t,e,s){this.log(3,t,e,s)}logZipProcessingStart(t){this.info("Processing",`\u041D\u0430\u0447\u0438\u043D\u0430\u044E \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 ZIP-\u0444\u0430\u0439\u043B\u0430: ${t}`)}logZipProcessingSuccess(t,e){this.info("Processing",`\u0423\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0430\u043D ZIP-\u0444\u0430\u0439\u043B: ${t}`,{noteName:e})}logZipProcessingError(t,e){this.error("Processing",`\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 ZIP-\u0444\u0430\u0439\u043B\u0430: ${t}`,{error:e.message,stack:e.stack})}logFileWatcherStart(t){this.info("FileWatcher",`\u0417\u0430\u043F\u0443\u0449\u0435\u043D\u043E \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438: ${t}`)}logFileWatcherStop(){this.info("FileWatcher","\u041E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E")}logFileWatcherError(t){this.error("FileWatcher","\u041E\u0448\u0438\u0431\u043A\u0430 \u0432 FileWatcher",{error:t.message,stack:t.stack})}logDuplicateHandling(t,e,s){this.info("Duplicates",`\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430 \u0434\u0443\u0431\u043B\u0438\u043A\u0430\u0442\u0430: ${e}`,{strategy:t,action:s})}logSettingsChange(t,e,s){this.info("Settings",`\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0430 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430: ${t}`,{oldValue:e,newValue:s})}logNoteCreation(t,e){this.info("NoteCreator",`\u0421\u043E\u0437\u0434\u0430\u043D\u0430 \u0437\u0430\u043C\u0435\u0442\u043A\u0430: ${t}`,{templateUsed:e})}logAudioFileCopy(t,e){this.info("AudioCopy",`\u0421\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u043D \u0430\u0443\u0434\u0438\u043E\u0444\u0430\u0439\u043B: ${t} -> ${e}`)}getAllLogs(){return[...this.logs]}getLogsByLevel(t){return this.logs.filter(e=>e.level>=t)}getLogsByCategory(t){return this.logs.filter(e=>e.category===t)}getRecentLogs(t=50){return this.logs.slice(-t)}exportLogsAsText(){return this.logs.map(e=>{let s=e.timestamp.toISOString(),i=et[e.level].padEnd(5),n=e.category.padEnd(12),r=`[${s}] [${i}] [${n}] ${e.message}`;return e.details&&(r+=`
    Details: ${JSON.stringify(e.details,null,2)}`),r}).join(`
`)}exportLogsAsJSON(){return JSON.stringify(this.logs,null,2)}clearLogs(){let t=this.logs.length;this.logs=[],this.info("System",`\u041E\u0447\u0438\u0449\u0435\u043D\u044B \u043B\u043E\u0433\u0438 (\u0431\u044B\u043B\u043E \u0437\u0430\u043F\u0438\u0441\u0435\u0439: ${t})`)}setLogLevel(t){let e=this.currentLogLevel;this.currentLogLevel=t,this.info("System",`\u0418\u0437\u043C\u0435\u043D\u0435\u043D \u0443\u0440\u043E\u0432\u0435\u043D\u044C \u043B\u043E\u0433\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F: ${et[e]} -> ${et[t]}`)}getLogStats(){let t={},e={};return this.logs.forEach(s=>{let i=et[s.level];t[i]=(t[i]||0)+1,e[s.category]=(e[s.category]||0)+1}),{total:this.logs.length,byLevel:t,byCategory:e}}async copyLogsToClipboard(){try{let t=this.exportLogsAsText();await navigator.clipboard.writeText(t),new Ft.Notice("\u{1F4CB} Logs copied to clipboard",3e3),this.info("System","\u041B\u043E\u0433\u0438 \u0441\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u043D\u044B \u0432 \u0431\u0443\u0444\u0435\u0440 \u043E\u0431\u043C\u0435\u043D\u0430")}catch(t){this.error("System","\u041E\u0448\u0438\u0431\u043A\u0430 \u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u043B\u043E\u0433\u043E\u0432 \u0432 \u0431\u0443\u0444\u0435\u0440 \u043E\u0431\u043C\u0435\u043D\u0430",t),new Ft.Notice("\u274C Error copying logs",5e3)}}};var _t=require("obsidian");var yt=class{constructor(t){this.statusBarItem=null;this.currentStatus="idle";this.currentMessage="";this.plugin=t,this.initialize()}initialize(){this.statusBarItem=this.plugin.addStatusBarItem(),this.statusBarItem.addClass("krisp-importer-status"),this.statusBarItem.style.cursor="pointer",this.statusBarItem.addEventListener("click",()=>{this.plugin.app.setting.open(),this.plugin.app.setting.openTabById("krisp-notes-importer")}),this.updateDisplay()}updateDisplay(){if(!this.statusBarItem)return;let{icon:t,text:e,color:s}=this.getStatusDisplay();this.statusBarItem.empty(),this.statusBarItem.removeClass("idle","watching","processing","error");let i=this.currentStatus.toLowerCase();this.statusBarItem.addClass(i);let n=this.statusBarItem.createEl("span");n.style.marginRight="4px",(0,_t.setIcon)(n,t);let r=this.statusBarItem.createEl("span");r.textContent=e,this.statusBarItem.style.color=s,this.statusBarItem.setAttribute("aria-label",this.getTooltipText())}getStatusDisplay(){switch(this.currentStatus){case"idle":return{icon:"pause-circle",text:"Krisp",color:"var(--text-muted)"};case"watching":return{icon:"eye",text:"Krisp",color:"var(--color-green)"};case"processing":return{icon:"loader-2",text:"Krisp",color:"var(--color-blue)"};case"error":return{icon:"alert-circle",text:"Krisp",color:"var(--color-red)"};default:return{icon:"help-circle",text:"Krisp",color:"var(--text-muted)"}}}getTooltipText(){let t="Krisp Notes Importer";switch(this.currentStatus){case"idle":return`${t}: \u041D\u0435\u0430\u043A\u0442\u0438\u0432\u0435\u043D`;case"watching":return`${t}: \u041E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u0430\u043A\u0442\u0438\u0432\u043D\u043E${this.currentMessage?` - ${this.currentMessage}`:""}`;case"processing":return`${t}: \u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430 \u0444\u0430\u0439\u043B\u0430${this.currentMessage?` - ${this.currentMessage}`:""}`;case"error":return`${t}: \u041E\u0448\u0438\u0431\u043A\u0430${this.currentMessage?` - ${this.currentMessage}`:""}`;default:return t}}setIdle(t){this.currentStatus="idle",this.currentMessage=t||"",this.updateDisplay()}setWatching(t){this.currentStatus="watching",this.currentMessage=t?`Watching: ${t}`:"",this.updateDisplay()}setProcessing(t){this.currentStatus="processing",this.currentMessage=t?`\u0424\u0430\u0439\u043B: ${t}`:"",this.updateDisplay()}setError(t){this.currentStatus="error",this.currentMessage=t||"",this.updateDisplay(),setTimeout(()=>{this.currentStatus==="error"&&this.setIdle()},1e4)}showTemporaryMessage(t,e=3e3){let s=this.currentStatus,i=this.currentMessage;this.currentMessage=t,this.updateDisplay(),setTimeout(()=>{this.currentStatus=s,this.currentMessage=i,this.updateDisplay()},e)}getCurrentStatus(){return this.currentStatus}isActive(){return this.currentStatus==="watching"||this.currentStatus==="processing"}destroy(){this.statusBarItem&&(this.statusBarItem.remove(),this.statusBarItem=null)}startProcessingAnimation(){if(!this.statusBarItem||this.currentStatus!=="processing")return;let t=this.statusBarItem.querySelector("span:first-child");t&&(t.style.animation="spin 1s linear infinite")}stopAnimation(){if(!this.statusBarItem)return;let t=this.statusBarItem.querySelector("span:first-child");t&&(t.style.animation="")}updateDisplayWithAnimation(){this.updateDisplay(),this.currentStatus==="processing"?this.startProcessingAnimation():this.stopAnimation()}};var Lt=class extends R.Plugin{async onload(){console.log("Loading Krisp Notes Importer plugin..."),this.loggingService=new It(1),this.loggingService.info("Plugin","\u041D\u0430\u0447\u0438\u043D\u0430\u044E \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0443 \u043F\u043B\u0430\u0433\u0438\u043D\u0430 Krisp Notes Importer"),this.settingsManager=new ut(this),await this.settingsManager.loadSettings(),this.loggingService.info("Plugin","Settings loaded");let e=this.settingsManager.getSetting("language")||"en";this.localizationService=new nt(e),this.loggingService.info("Plugin",`\u041B\u043E\u043A\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u043D\u0430: ${e}`),this.notificationService=new ot,this.statusBarService=new yt(this),this.processingService=new wt(this.app,this.statusBarService),this.loggingService.info("Plugin","\u041E\u0441\u043D\u043E\u0432\u043D\u044B\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u044B \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u043D\u044B"),this.fileWatcherService=new vt(this.app,this.processingService,this.notificationService,()=>this.settingsManager.getAllSettings(),this.statusBarService),this.addSettingTab(new mt(this.app,this)),this.addCommand({id:"import-krisp-zip-manually",name:this.localizationService.t("commands.importZip"),callback:()=>{this.loggingService.info("Commands","\u0417\u0430\u043F\u0443\u0449\u0435\u043D\u0430 \u043A\u043E\u043C\u0430\u043D\u0434\u0430 \u0440\u0443\u0447\u043D\u043E\u0433\u043E \u0438\u043C\u043F\u043E\u0440\u0442\u0430 ZIP-\u0444\u0430\u0439\u043B\u0430"),new $t(this.app,async n=>{n&&n.trim()!==""?(this.loggingService.info("Commands",`\u041D\u0430\u0447\u0438\u043D\u0430\u044E \u0440\u0443\u0447\u043D\u043E\u0439 \u0438\u043C\u043F\u043E\u0440\u0442 \u0444\u0430\u0439\u043B\u0430: ${n}`),new R.Notice(`Starting import for: ${n}`),await this.processingService.processZipFile(n,this.settingsManager.settings)):(this.loggingService.warn("Commands","\u041F\u043E\u043F\u044B\u0442\u043A\u0430 \u0438\u043C\u043F\u043E\u0440\u0442\u0430 \u0441 \u043F\u0443\u0441\u0442\u044B\u043C \u043F\u0443\u0442\u0435\u043C \u043A \u0444\u0430\u0439\u043B\u0443"),new R.Notice("File path cannot be empty."))},this.localizationService).open()}}),this.addCommand({id:"start-auto-watching",name:this.localizationService.t("commands.startWatching"),callback:async()=>{let n=this.settingsManager.getSetting("watchedFolderPath");n&&n.trim()!==""?(this.statusBarService.setWatching(n),await this.fileWatcherService.startWatching(n)):(this.statusBarService.setError("No watched folder specified"),new R.Notice("Please set the watched folder path in settings first."))}}),this.addCommand({id:"stop-auto-watching",name:this.localizationService.t("commands.stopWatching"),callback:async()=>{this.statusBarService.setIdle("\u041E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E"),await this.fileWatcherService.stopWatching()}}),this.addCommand({id:"scan-existing-files",name:this.localizationService.t("commands.scanExisting"),callback:async()=>{this.statusBarService.setProcessing("\u0421\u043A\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0444\u0430\u0439\u043B\u043E\u0432"),await this.fileWatcherService.scanExistingFiles(),this.statusBarService.setIdle("\u0421\u043A\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043E")}}),this.addCommand({id:"debug-settings",name:this.localizationService.t("commands.debugSettings"),callback:()=>{let n=this.settingsManager.getAllSettings();console.log("[Krisp Importer] Current settings:",n),new R.Notice(`Settings logged to console. deleteZipAfterImport: ${n.deleteZipAfterImport}`,5e3)}}),this.addCommand({id:"check-watching-status",name:this.localizationService.t("commands.checkStatus"),callback:()=>{let n=this.fileWatcherService.isCurrentlyWatching(),r=this.fileWatcherService.getWatchedPath(),p=this.settingsManager.getSetting("autoScanEnabled");console.log("[Krisp Importer] Watching status:",{isWatching:n,watchedPath:r,autoScanEnabled:p});let l=n?`\u2705 \u041E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u0430\u043A\u0442\u0438\u0432\u043D\u043E: ${r}`:`\u274C \u041E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u0435 \u043D\u0435\u0430\u043A\u0442\u0438\u0432\u043D\u043E. AutoScan \u0432 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430\u0445: ${p?"\u0432\u043A\u043B\u044E\u0447\u0435\u043D":"\u0432\u044B\u043A\u043B\u044E\u0447\u0435\u043D"}`;new R.Notice(l,7e3)}});let s=this.settingsManager.getSetting("autoScanEnabled"),i=this.settingsManager.getSetting("watchedFolderPath");s&&i&&i.trim()!==""?(this.loggingService.info("Plugin",`\u0410\u0432\u0442\u043E\u0437\u0430\u043F\u0443\u0441\u043A \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u044F \u043F\u0430\u043F\u043A\u0438: ${i}`),this.statusBarService.setWatching(i),await this.fileWatcherService.startWatching(i)):this.statusBarService.setIdle("\u0413\u043E\u0442\u043E\u0432 \u043A \u0440\u0430\u0431\u043E\u0442\u0435"),this.loggingService.info("Plugin","\u041F\u043B\u0430\u0433\u0438\u043D Krisp Notes Importer \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D \u0443\u0441\u043F\u0435\u0448\u043D\u043E"),console.log("Krisp Notes Importer plugin loaded successfully.")}onunload(){this.fileWatcherService&&this.fileWatcherService.stopWatching(),this.statusBarService&&this.statusBarService.destroy(),this.loggingService&&this.loggingService.info("Plugin","\u0412\u044B\u0433\u0440\u0443\u0436\u0430\u044E \u043F\u043B\u0430\u0433\u0438\u043D Krisp Notes Importer"),console.log("Unloading Krisp Notes Importer plugin.")}},$t=class extends R.Modal{constructor(e,s,i){super(e);this.onSubmitCallback=s,this.localization=i}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:this.localization.t("modal.importZip.title")}),new R.Setting(e).setName(this.localization.t("modal.importZip.pathLabel")).setDesc(this.localization.t("modal.importZip.pathDesc")).addText(s=>{s.setPlaceholder("/path/to/your/krisp_meeting.zip"),s.onChange(i=>{this.filePath=i}),s.inputEl.style.width="100%",s.inputEl.addEventListener("keypress",i=>{i.key==="Enter"&&(i.preventDefault(),this.submitForm())})}),new R.Setting(e).addButton(s=>s.setButtonText(this.localization.t("modal.importZip.importButton")).setCta().onClick(()=>{this.submitForm()}))}submitForm(){this.filePath&&this.filePath.trim()!==""?(this.onSubmitCallback(this.filePath.trim()),this.close()):new R.Notice(this.localization.t("modal.importZip.emptyPathError"))}onClose(){let{contentEl:e}=this;e.empty()}};
/*! Bundled license information:

node-stream-zip/node_stream_zip.js:
  (**
   * @license node-stream-zip | (c) 2020 Antelle | https://github.com/antelle/node-stream-zip/blob/master/LICENSE
   * Portions copyright https://github.com/cthackers/adm-zip | https://raw.githubusercontent.com/cthackers/adm-zip/master/LICENSE
   *)
*/

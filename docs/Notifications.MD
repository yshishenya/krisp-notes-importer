# Логика уведомлений плагина "Krisp Notes Importer"

## 1. Общие принципы

Уведомления должны быть:
*   **Своевременными:** Появляться тогда, когда это необходимо пользователю.
*   **Информативными:** Предоставлять достаточно информации для понимания ситуации.
*   **Ненавязчивыми:** Не должны мешать работе пользователя, если это не критическое сообщение.
*   **Действенными (по возможности):** Предлагать варианты действий, если это уместно.

Плагин будет использовать стандартный механизм уведомлений Obsidian (`new Notice("сообщение", длительность_в_мс)`).

## 2. Типы уведомлений и сценарии

### 2.1. Успешный импорт

*   **Событие:** Успешная обработка ZIP-архива и создание заметки (или нескольких заметок, если архив содержал несколько встреч).
*   **Тип уведомления:** Информационное (зеленое или нейтральное).
*   **Содержание:**
    *   Если импортирована одна встреча: "Встреча '[Название встречи]' успешно импортирована!"
    *   Если импортировано несколько встреч из одного архива: "Импортировано [N] встреч(и) из архива '[Имя ZIP-файла]'."
*   **Длительность:** 3-5 секунд.
*   **Действия:**
    *   Если в настройках включено "Открывать заметку после импорта", то после уведомления заметка будет открыта.
    *   (Опционально, для продвинутых уведомлений) Уведомление может содержать кликабельную ссылку для быстрого перехода к созданной заметке (если импортирована одна) или к первой из созданных.

### 2.2. Ошибки импорта

*   **Событие:** Возникновение ошибки на любом этапе обработки ZIP-файла.
*   **Тип уведомления:** Ошибка (красное).
*   **Содержание (примеры):**
    *   **Ошибка распаковки:** "Ошибка распаковки архива '[Имя ZIP-файла]'. Файл может быть поврежден или не является ZIP-архивом."
    *   **Не найдены обязательные файлы:** "В архиве '[Имя ZIP-файла]' (встреча '[Имя папки встречи]') не найдены обязательные файлы: [список отсутствующих файлов, например, meeting_notes.txt]."
    *   **Ошибка чтения файла:** "Не удалось прочитать файл '[Имя файла]' из архива '[Имя ZIP-файла]'."
    *   **Ошибка создания заметки:** "Не удалось создать заметку для встречи '[Название встречи]'. Проверьте права доступа и настройки папки для заметок."
    *   **Ошибка сохранения аудио:** "Не удалось сохранить аудиофайл для встречи '[Название встречи]'. Проверьте права доступа и настройки папки для аудиофайлов."
    *   **Общая ошибка:** "Произошла ошибка при импорте встречи из '[Имя ZIP-файла]'. Подробности в логах плагина."
*   **Длительность:** 5-10 секунд (или до закрытия пользователем, если это возможно).
*   **Действия:**
    *   Предложить пользователю проверить логи плагина для получения детальной информации.
    *   Уведомление может содержать кнопку "Показать логи" или "Скопировать детали ошибки".

### 2.3. Обнаружение дубликата

*   **Событие:** Обнаружение существующей заметки с таким же предполагаемым именем (или соответствие другим критериям дублирования).
*   **Тип уведомления:** Предупреждение (желтое) или информационное, в зависимости от выбранной стратегии.
*   **Содержание (в зависимости от стратегии):**
    *   **Стратегия "Пропустить импорт":** "Встреча '[Название предполагаемой заметки]' уже существует. Импорт пропущен со_гласно настройкам."
    *   **Стратегия "Перезаписать":** "Встреча '[Название заметки]' уже существует и была перезаписана согласно настройкам."
    *   **Стратегия "Создать с суффиксом":** "Встреча '[Название исходной заметки]' уже существует. Создана новая заметка '[Название новой заметки с суффиксом]'."
*   **Длительность:** 4-7 секунд.
*   **Действия (для стратегии "Пропустить" или если требуется подтверждение):**
    *   (Опционально, если API Obsidian позволит создавать интерактивные уведомления) Уведомление может предложить пользователю выбор: "Встреча '[Имя]' уже существует. [Перезаписать] [Пропустить] [Создать копию]".
    *   Ссылка на существующую заметку-дубликат.

### 2.4. Начало и завершение отслеживания папки

*   **Событие:** Запуск или остановка автоматического отслеживания папки (например, при загрузке/выгрузке плагина или изменении соответствующей настройки).
*   **Тип уведомления:** Информационное.
*   **Содержание:**
    *   "Krisp Importer: Отслеживание папки '[Путь к папке]' запущено."
    *   "Krisp Importer: Отслеживание папки остановлено."
*   **Длительность:** 2-3 секунды.

### 2.5. Ошибки конфигурации/настроек

*   **Событие:** Обнаружение некорректных настроек, которые мешают работе плагина (например, не указана отслеживаемая папка, указанная папка не существует).
*   **Тип уведомления:** Ошибка (красное).
*   **Содержание:**
    *   "Krisp Importer: Отслеживаемая папка не указана или не существует. Пожалуйста, проверьте настройки плагина."
    *   "Krisp Importer: Папка для заметок '[Путь]' не доступна для записи."
*   **Длительность:** 5-10 секунд.
*   **Действия:** Предложить открыть настройки плагина.

### 2.6. Статус массового импорта (ручной запуск)

*   **Событие:** Запуск ручного импорта всех файлов из отслеживаемой папки.
*   **Тип уведомления:** Информационное.
*   **Содержание:**
    *   **Начало:** "Запущен импорт [N] файлов из отслеживаемой папки..."
    *   **Завершение:** "Массовый импорт завершен. Импортировано: [X] встреч. Ошибок: [Y]. Пропущено дубликатов: [Z]. Подробности в логах."
*   **Длительность:** Начальное - 3 сек, конечное - 5-7 сек.

## 3. Логирование

В дополнение к видимым уведомлениям, плагин должен вести подробный журнал своей работы (логи). Это поможет в диагностике проблем.
*   **Уровни логирования (предположительно):** INFO, WARN, ERROR.
*   **Содержимое логов:**
    *   Время события.
    *   Обрабатываемый файл/встреча.
    *   Выполняемое действие.
    *   Результат операции (успех/ошибка с деталями).
    *   Примененные настройки (например, стратегия обработки дубликатов).
*   **Доступ к логам:** Через кнопку в настройках плагина ("Показать логи" или "Скопировать логи"). Логи могут выводиться в консоль разработчика Obsidian или записываться в отдельный файл в папке плагина (если это безопасно и разрешено API).

## 4. Интерактивность уведомлений (Желательно, если поддерживается API)

Если API Obsidian позволяет, некоторые уведомления (например, об обнаружении дубликата) могут содержать кнопки для выполнения быстрых действий непосредственно из уведомления, без необходимости открывать настройки.

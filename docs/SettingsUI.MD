# Пользовательский интерфейс настроек плагина "Krisp Notes Importer"

## 1. Общий вид

Страница настроек плагина будет доступна в стандартном разделе настроек Obsidian (Community Plugins -> Krisp Notes Importer -> Settings).
Она будет разделена на логические секции или вкладки для удобства навигации.

## 2. Мастер первоначальной настройки (Setup Wizard)

При первом открытии настроек плагина или по специальной кнопке "Запустить мастер настройки" будет предложен пошаговый процесс конфигурации:

*   **Шаг 1: Папка для отслеживания Krisp архивов**
    *   **Заголовок:** "Укажите папку для импорта"
    *   **Описание:** "Выберите папку, куда Krisp будете сохранять ZIP-архивы ваших встреч. Плагин будет автоматически отслеживать эту папку."
    *   **Элемент:**
        *   Текстовое поле (нередактируемое или отображающее текущий путь) с кнопкой "Обзор..." (`<input type="text" readonly>`, `<button>Обзор...</button>`).
        *   Плагин попытается автоматически определить стандартную папку Krisp и предложит ее.
    *   **Кнопки:** "Далее", "Пропустить"

*   **Шаг 2: Папки для заметок и аудио в Obsidian**
    *   **Заголовок:** "Куда сохранять импортированные данные?"
    *   **Описание:** "Укажите, где в вашем хранилище Obsidian будут создаваться заметки и сохраняться аудиофайлы."
    *   **Элементы:**
        *   **Папка для заметок:** Текстовое поле с предлагаемым по умолчанию путем (например, `Meetings/Krisp Importer/Notes`) и кнопкой "Обзор папки хранилища..." (если API позволяет такой выбор).
        *   **Папка для аудиофайлов:** Текстовое поле с предлагаемым по умолчанию путем (например, `Attachments/Krisp Importer/Audio`) и кнопкой "Обзор папки хранилища...".
    *   **Кнопки:** "Назад", "Далее", "Пропустить"

*   **Шаг 3: Основные опции импорта**
    *   **Заголовок:** "Как обрабатывать импорт?"
    *   **Описание:** "Выберите основные параметры для процесса импорта."
    *   **Элементы:**
        *   Чекбокс: "Включить автоматическое отслеживание папки" (по умолчанию включен).
        *   Чекбокс: "Удалять исходный ZIP-файл после успешного импорта" (по умолчанию выключен).
        *   Чекбокс: "Открывать созданную заметку после импорта" (по умолчанию включен).
    *   **Кнопки:** "Назад", "Завершить"

## 3. Основная страница настроек

Будет иметь следующую структуру (возможно, с вкладками или сворачиваемыми секциями):

### 3.1. Секция "Основные настройки"

*   **Отслеживаемая папка Krisp:**
    *   **Описание:** "Папка, которую плагин будет отслеживать на предмет появления новых ZIP-архивов Krisp."
    *   **Элемент:** Текстовое поле с текущим путем и кнопкой "Выбрать папку..." (открывает системный диалог).
    *   **Подсказка:** "Укажите полный путь к папке."

*   **Включить автоматическое отслеживание:**
    *   **Описание:** "Автоматически сканировать указанную папку и импортировать новые встречи."
    *   **Элемент:** Чекбокс (`<input type="checkbox">`).

### 3.2. Секция "Сохранение в Obsidian"

*   **Папка для заметок:**
    *   **Описание:** "Папка в вашем хранилище Obsidian, куда будут сохраняться Markdown-заметки."
    *   **Элемент:** Текстовое поле (относительный путь от корня хранилища) с кнопкой "Выбрать папку в хранилище..." (если возможно) или просто текстовое поле.
    *   **Пример:** `Meetings/Krisp Importer/Notes`

*   **Папка для аудиофайлов:**
    *   **Описание:** "Папка в вашем хранилище Obsidian, куда будут сохраняться аудиофайлы."
    *   **Элемент:** Текстовое поле (относительный путь) с кнопкой "Выбрать папку в хранилище..." или просто текстовое поле.
    *   **Пример:** `Attachments/Krisp Importer/Audio`

### 3.3. Секция "Шаблоны и именование"

*   **Шаблон имени для заметок:**
    *   **Описание:** "Определите, как будут называться файлы заметок. Доступные переменные: {{YYYY}}, {{MM}}, {{DD}}, {{HHMM}}, {{meetingTitle}}."
    *   **Элемент:** Текстовое поле.
    *   **Пример ввода:** `{{YYYY}}-{{MM}}-{{DD}}_{{HHMM}}_{{meetingTitle}}`
    *   **Предпросмотр:** (Динамически обновляемый пример) `2024-07-15_1030_Обсуждение проекта.md`

*   **Шаблон имени для аудиофайлов:**
    *   **Описание:** "Определите, как будут называться аудиофайлы. Переменные те же."
    *   **Элемент:** Текстовое поле.
    *   **Пример ввода:** `{{YYYY}}-{{MM}}-{{DD}}_{{meetingTitle}}.mp3`
    *   **Предпросмотр:** `2024-07-15_Обсуждение проекта.mp3`

*   **Шаблон содержимого заметки:**
    *   **Описание:** "Отредактируйте шаблон для создаваемых заметок. Вы можете использовать Markdown и следующие переменные: {{title}}, {{date}}, {{time}}, {{participants}}, {{summary}}, {{actionItems}}, {{keyPoints}}, {{transcriptLink}}, {{audioLink}}, {{rawNotesContent}}, {{rawTranscriptContent}}."
    *   **Элемент:** Многострочное текстовое поле (`<textarea>`).
    *   **Кнопка:** "Восстановить шаблон по умолчанию".
    *   **Примечание:** Плагин будет поставляться с качественным шаблоном по умолчанию.

### 3.4. Секция "Обработка дубликатов"

*   **Стратегия при обнаружении дубликата:**
    *   **Описание:** "Что делать, если плагин обнаруживает, что встреча уже была импортирована (проверка по имени заметки)?"
    *   **Элемент:** Выпадающий список (`<select>`):
        *   "Пропустить импорт" (по умолчанию).
        *   "Перезаписать существующую заметку и аудиофайл".
        *   "Создать новую заметку (добавить суффикс к имени, например, _v2)".
    *   **Подсказка:** Описание выбранной стратегии.

### 3.5. Секция "Действия после импорта"

*   **Удалять исходный ZIP-файл:**
    *   **Описание:** "Автоматически удалять ZIP-архив из отслеживаемой папки после успешного импорта."
    *   **Элемент:** Чекбокс.

*   **Открывать заметку после импорта:**
    *   **Описание:** "Автоматически открывать созданную заметку в Obsidian."
    *   **Элемент:** Чекбокс.

### 3.6. Секция "Дополнительно / Обслуживание"

*   **Язык для распознавания дат (если автоопределение не сработало):**
    *   **Описание:** "Выберите язык, на котором указаны месяцы в названиях встреч Krisp, если автоматическое определение не справляется."
    *   **Элемент:** Выпадающий список (например, "Английский", "Русский").

*   **Кнопка "Протестировать импорт одного файла":**
    *   **Описание:** "Выберите ZIP-файл Krisp для тестовой обработки с текущими настройками. Фактического сохранения в хранилище не произойдет (или будет создана временная заметка)."
    *   **Элемент:** Кнопка.

*   **Кнопка "Импортировать все файлы из отслеживаемой папки сейчас":**
    *   **Описание:** "Запустить обработку всех необработанных ZIP-файлов в отслеживаемой папке немедленно."
    *   **Элемент:** Кнопка.

*   **Кнопка "Показать логи плагина":**
    *   **Описание:** "Открыть или скопировать в буфер обмена журнал работы плагина для диагностики."
    *   **Элемент:** Кнопка.

*   **Кнопка "Сбросить все настройки плагина по умолчанию":**
    *   **Описание:** "Вернуть все настройки плагина к исходным значениям."
    *   **Элемент:** Кнопка.

*   **Кнопка "Запустить мастер первоначальной настройки":**
    *   **Элемент:** Кнопка.

*   **Переключатель "Режим настроек: Простой / Расширенный" (опционально):**
    *   **Описание:** "Показать только основные настройки или все доступные опции."
    *   **Элемент:** Переключатель.

## 4. Индикация статуса

*   В строке состояния Obsidian может отображаться иконка и/или краткий текст, указывающий на статус плагина: "Krisp Importer: Активен", "Krisp Importer: Идет импорт...", "Krisp Importer: Ошибка" (при клике может открывать настройки или логи).

## 5. Используемые элементы Obsidian API для UI

*   `PluginSettingTab` для создания страницы настроек.
*   `Setting` для создания отдельных блоков настроек.
*   Компоненты `TextComponent`, `TextAreaComponent`, `ButtonComponent`, `DropdownComponent`, `ToggleComponent` для создания элементов управления.
*   `Notice` для уведомлений (описано в `Notifications.MD`).
*   Возможно, API для системного диалога выбора папок (если доступно и удобно).

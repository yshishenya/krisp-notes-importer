# Software Requirements Specification (SRS) for Krisp Notes Importer Obsidian Plugin

## 1. Введение

### 1.1. Назначение
Плагин "Krisp Notes Importer" для Obsidian предназначен для автоматизации процесса импорта заметок и аудиозаписей встреч из ZIP-архивов, генерируемых приложением Krisp. Плагин будет отслеживать указанную пользователем папку, обрабатывать новые ZIP-архивы, извлекать из них информацию о встречах, создавать структурированные Markdown-заметки в Obsidian и сохранять связанные аудиофайлы.

### 1.2. Область применения
Плагин предназначен для пользователей Obsidian, которые используют Krisp для записи встреч и хотят интегрировать этот процесс в свою систему управления знаниями.

### 1.3. Определения, акронимы и сокращения
*   **SRS:** Software Requirements Specification (Спецификация требований к программному обеспечению)
*   **Krisp:** Приложение для шумоподавления и записи встреч.
*   **Obsidian:** Приложение для ведения заметок и управления знаниями.
*   **ZIP:** Формат архивации файлов.
*   **Markdown (MD):** Язык разметки для создания форматированных текстовых документов.
*   **API:** Application Programming Interface (Интерфейс прикладного программирования).
*   **UI:** User Interface (Пользовательский интерфейс).
*   **YAML Frontmatter:** Блок метаданных в начале Markdown-файла.

### 1.4. Ссылки
*   Obsidian API Documentation: [https://github.com/obsidianmd/obsidian-api](https://github.com/obsidianmd/obsidian-api)
*   Krisp: [https://krisp.ai/](https://krisp.ai/)

### 1.5. Обзор документа
Данный документ описывает функциональные и нефункциональные требования к плагину "Krisp Notes Importer". Он включает описание пользовательских сценариев, интерфейсов и атрибутов качества.

## 2. Общее описание

### 2.1. Перспективы продукта
Плагин будет являться дополнением (community plugin) для Obsidian и расширять его возможности по импорту и организации информации из внешних источников.

### 2.2. Функции продукта
Основные функции плагина:
*   Настройка отслеживаемой папки для ZIP-архивов Krisp.
*   Настройка целевых папок в Obsidian для заметок и аудиофайлов.
*   Автоматическое обнаружение и обработка новых ZIP-архивов.
*   Распаковка архивов и извлечение файлов (`meeting_notes.txt`, `transcript.txt`, `recording.mp3`).
*   Парсинг `meeting_notes.txt` для извлечения метаданных (название, дата, время, участники, ключевые пункты, действия).
*   Форматирование транскрипта (`transcript.txt`) с кликабельными временными метками.
*   Создание структурированных Markdown-заметок в Obsidian с использованием YAML Frontmatter и настраиваемого шаблона.
*   Сохранение аудиофайлов в указанную папку вложений Obsidian.
*   Проверка на дублирование импортируемых данных.
*   Предоставление уведомлений о статусе импорта.
*   Возможность ручного запуска импорта.

### 2.3. Характеристики пользователей
*   Пользователи Obsidian.
*   Пользователи Krisp.
*   Пользователи, стремящиеся автоматизировать свой рабочий процесс по обработке записей встреч.

### 2.4. Общие ограничения
*   Плагин будет работать в среде Obsidian и зависеть от его API.
*   Для распаковки ZIP-архивов потребуется соответствующая библиотека (например, `jszip`).
*   Формат файлов внутри ZIP-архива Krisp предполагается стандартным (`meeting_notes.txt`, `transcript.txt`, `recording.mp3`). Изменения в формате Krisp могут потребовать обновления плагина.

### 2.5. Предположения и зависимости
*   У пользователя установлен Obsidian версии, поддерживающей API для работы с файловой системой и создания заметок.
*   Пользователь имеет права на чтение из отслеживаемой папки и на запись в папки хранилища Obsidian.

## 3. Конкретные требования

### 3.1. Требования к интерфейсу

#### 3.1.1. Пользовательский интерфейс (UI)
Плагин будет предоставлять страницу настроек в Obsidian, где пользователь сможет указать:
*   **Отслеживаемая папка:** Полный путь к папке, где появляются ZIP-архивы Krisp. **Должна быть возможность выбора папки через системный диалог ("Обзор...").**
*   **Папка для заметок:** Путь внутри хранилища Obsidian, куда будут сохраняться созданные Markdown-заметки. **Плагин должен предлагать умные значения по умолчанию (например, `Meetings/Krisp Importer/Notes`).**
*   **Папка для аудиофайлов:** Путь внутри хранилища Obsidian для сохранения аудиозаписей. **Плагин должен предлагать умные значения по умолчанию (например, `Attachments/Krisp Importer/Audio`).**
*   **Шаблон заметки (опционально):** Возможность указать путь к файлу шаблона Obsidian или ввести текст шаблона. **Должны предоставляться примеры форматирования и список доступных плейсхолдеров.**
*   **Стратегия обработки дубликатов:** Выбор из опций (пропустить, перезаписать, создать с суффиксом). **Каждая опция должна иметь понятное описание.**
*   **Настройка именования файлов:** Шаблон для имен заметок и аудиофайлов **с примерами и списком доступных плейсхолдеров.**
*   **Опции после импорта:** Автоматически открывать заметку, удалять исходный ZIP.
*   **Группировка настроек:** Настройки должны быть логически сгруппированы (например, "Основные", "Файлы и Папки", "Шаблоны", "Дополнительно") для улучшения навигации и восприятия.
*   **Подсказки (Tooltips):** Каждая настройка должна сопровождаться краткой всплывающей подсказкой, объясняющей ее назначение.
*   **Кнопка "Сбросить настройки по умолчанию":** Позволяет пользователю восстановить стандартные настройки плагина.
*   **Мастер первоначальной настройки (Setup Wizard):** При первом запуске плагина или по вызову из настроек, должен запускаться пошаговый мастер для конфигурации основных параметров.
*   **Индикация статуса плагина:** Отображение текущего состояния работы плагина (например, в строке состояния Obsidian или специальной иконкой).
*   **Кнопка "Тестовый импорт":** Позволяет пользователю выбрать ZIP-файл и увидеть превью создаваемой заметки и предполагаемых действий (без фактического сохранения в хранилище или с сохранением во временную/специальную заметку) для проверки текущих настроек.
*   **Режим отображения настроек (опционально):** Возможность переключения между "Простым" (только основные и часто используемые настройки) и "Расширенным" режимом.
*   Кнопка для ручного запуска обработки всех ZIP-файлов в отслеживаемой папке.

#### 3.1.2. Программные интерфейсы (API)
*   Плагин будет использовать Obsidian API для:
    *   Доступа к файловой системе (чтение отслеживаемой папки, создание/изменение файлов в хранилище).
    *   Создания и отображения уведомлений.
    *   Регистрации команд (для ручного запуска).
    *   Доступа к настройкам плагина.
*   Для работы с ZIP-архивами будет использоваться сторонняя библиотека (например, `jszip`).

### 3.2. Функциональные требования

#### 3.2.1. Настройка плагина (FUNC-SETUP)
*   **FUNC-SETUP-001:** Пользователь должен иметь возможность указать абсолютный путь к папке для отслеживания новых ZIP-архивов Krisp.
*   **FUNC-SETUP-002:** Пользователь должен иметь возможность указать относительный путь внутри хранилища Obsidian для сохранения создаваемых Markdown-заметок. **Плагин должен предлагать разумные пути по умолчанию.**
*   **FUNC-SETUP-003:** Пользователь должен иметь возможность указать относительный путь внутри хранилища Obsidian для сохранения аудиофайлов. **Плагин должен предлагать разумные пути по умолчанию.**
*   **FUNC-SETUP-004:** Пользователь должен иметь возможность выбрать стратегию обработки дубликатов (пропустить, перезаписать, создать с суффиксом). **Стратегия "Создать с суффиксом" должна быть выбрана по умолчанию как наиболее безопасная.**
*   **FUNC-SETUP-005:** Пользователь должен иметь возможность определить шаблон именования для создаваемых заметок и аудиофайлов (с использованием плейсхолдеров, например, `{{YYYY-MM-DD}}`, `{{HHMM}}`, `{{meetingTitle}}`).
*   **FUNC-SETUP-006:** Пользователь должен иметь возможность указать шаблон для содержимого создаваемой заметки (плейсхолдеры: `{{title}}`, `{{date}}`, `{{time}}`, `{{participants}}`, `{{summary}}`, `{{actionItems}}`, `{{keyPoints}}`, `{{transcript}}`, `{{audioLink}}`). **Плагин должен поставляться с качественным, продуманным шаблоном по умолчанию.**
*   **FUNC-SETUP-007:** Пользователь должен иметь возможность включить/выключить опцию автоматического удаления исходного ZIP-файла после успешного импорта.
*   **FUNC-SETUP-008:** Пользователь должен иметь возможность включить/выключить опцию автоматического открытия созданной заметки после импорта.
*   **FUNC-SETUP-009:** Пользователь должен иметь легкий доступ к логам работы плагина для диагностики (например, через команду или кнопку в настройках, копирующую логи в буфер обмена или открывающую файл лога).

#### 3.2.2. Отслеживание папки (FUNC-WATCH)
*   **FUNC-WATCH-001:** Плагин должен отслеживать указанную папку на предмет появления новых файлов с расширением `.zip`.
*   **FUNC-WATCH-002:** При обнаружении нового ZIP-файла плагин должен инициировать процесс его обработки.

#### 3.2.3. Обработка ZIP-архива (FUNC-PROCESS)
*   **FUNC-PROCESS-001:** Плагин должен распаковать ZIP-архив во временную директорию.
*   **FUNC-PROCESS-002:** Плагин должен найти и прочитать содержимое файлов `meeting_notes.txt`, `transcript.txt` и найти файл `recording.mp3` внутри каждой папки встречи в архиве.
*   **FUNC-PROCESS-003:** Если необходимые файлы не найдены, плагин должен зарегистрировать ошибку и уведомить пользователя.

#### 3.2.4. Извлечение данных (FUNC-EXTRACT)
*   **FUNC-EXTRACT-001:** Плагин должен извлекать из `meeting_notes.txt` (первой строки) дату и время встречи.
*   **FUNC-EXTRACT-002:** Плагин должен извлекать название встречи из имени папки внутри архива (удаляя UUID).
*   **FUNC-EXTRACT-003:** Плагин должен извлекать из `meeting_notes.txt` секции "Action Items", "Summary", "Key Points".
*   **FUNC-EXTRACT-004:** Плагин должен извлекать список участников из `transcript.txt`.
*   **FUNC-EXTRACT-005:** Плагин должен форматировать `transcript.txt`, делая временные метки кликабельными (в формате `[[ЧЧ:ММ]]` или `[[ЧЧ:ММ:СС]]`).
*   **FUNC-EXTRACT-006:** Плагин должен корректно обрабатывать различные форматы дат и времени, встречающиеся в Krisp.

#### 3.2.5. Создание заметки (FUNC-CREATE-NOTE)
*   **FUNC-CREATE-NOTE-001:** Плагин должен создавать новую Markdown-заметку в указанной пользователем папке.
*   **FUNC-CREATE-NOTE-002:** Имя файла заметки должно формироваться согласно настроенному шаблону.
*   **FUNC-CREATE-NOTE-003:** Заметка должна содержать YAML Frontmatter с полями: `title`, `date`, `time`, `type: meeting`, `source: krisp`, `tags: [meeting, krisp, ...]`, `audio`, `participants`, `duration`.
*   **FUNC-CREATE-NOTE-004:** Содержимое заметки должно формироваться на основе пользовательского шаблона и извлеченных данных. По умолчанию должна быть структура, аналогичная реализованной в bash-скрипте.
*   **FUNC-CREATE-NOTE-005:** В заметке должна быть ссылка на аудиофайл в формате, подходящем для встроенного аудиоплеера Obsidian (`<audio src="..."></audio>`).

#### 3.2.6. Сохранение аудиофайла (FUNC-SAVE-AUDIO)
*   **FUNC-SAVE-AUDIO-001:** Плагин должен копировать/перемещать файл `recording.mp3` в указанную пользователем папку для вложений.
*   **FUNC-SAVE-AUDIO-002:** Имя аудиофайла должно формироваться согласно настроенному шаблону и соответствовать ссылке в заметке.

#### 3.2.7. Обработка дубликатов (FUNC-DUPLICATES)
*   **FUNC-DUPLICATES-001:** Перед импортом плагин должен проверять наличие дубликатов по имени создаваемой.
*   **FUNC-DUPLICATES-002 :** Возможность проверки дубликатов по хеш-сумме содержимого `meeting_notes.txt`.
*   **FUNC-DUPLICATES-003:** В зависимости от выбранной стратегии, плагин должен пропустить импорт, перезаписать существующие файлы или создать новые с уникальным именем.

#### 3.2.8. Уведомления (FUNC-NOTIFY)
*   **FUNC-NOTIFY-001:** Плагин должен уведомлять пользователя о успешном импорте каждой встречи.
*   **FUNC-NOTIFY-002:** Плагин должен уведомлять пользователя об ошибках, возникших в процессе импорта (например, не найдены файлы, ошибка распаковки, ошибка записи).
*   **FUNC-NOTIFY-003:** Плагин должен уведомлять пользователя при обнаружении дубликата и предпринятом действии. **Уведомления, где это уместно (например, при обнаружении дубликата), могут быть интерактивными, предлагая варианты действий или быстрый переход к существующей заметке.**

#### 3.2.9. Ручной импорт (FUNC-MANUAL-IMPORT)
*   **FUNC-MANUAL-IMPORT-001:** Плагин должен предоставлять команду Obsidian для ручного выбора одного ZIP-файла для импорта.
*   **FUNC-MANUAL-IMPORT-002:** Плагин должен предоставлять команду Obsidian для обработки всех ZIP-файлов в отслеживаемой папке.

### 3.3. Нефункциональные требования

#### 3.3.1. Производительность
*   **PERF-001:** Обработка одного ZIP-архива среднего размера (например, с аудиозаписью до 1 часа) не должна занимать более нескольких секунд (без учета времени копирования файла).
*   **PERF-002:** Отслеживание папки не должно значительно нагружать систему.

#### 3.3.2. Надежность
*   **REL-001:** Плагин должен корректно обрабатывать ошибки (например, отсутствие файлов, неправильный формат) и не приводить к падению Obsidian.
*   **REL-002:** В случае ошибки при обработке одного файла, плагин должен продолжать работу и пытаться обработать следующие файлы.

#### 3.3.3. Удобство использования (Usability)
*   **USE-001:** Настройки плагина должны быть понятными и легко конфигурируемыми.
*   **USE-002:** Уведомления должны быть информативными.
*   **USE-003: Мастер первоначальной настройки** должен интуитивно провести пользователя через основные шаги конфигурации при первом использовании плагина или при сбросе настроек.
*   **USE-004: Минимизация ручного ввода данных:** Предпочтение должно отдаваться выбору из списков, автодополнению, визуальным элементам управления и умным значениям по умолчанию вместо необходимости ручного ввода путей и сложных параметров.
*   **USE-005: Обратная связь с пользователем:** Плагин должен предоставлять четкую обратную связь о своих действиях и состоянии.

#### 3.3.4. Поддерживаемость (Maintainability)
*   **MAINT-001:** Код плагина должен быть написан на TypeScript, хорошо структурирован и прокомментирован для облегчения дальнейшей поддержки и доработок.

### 3.4. Требования к данным
*   Плагин будет обрабатывать данные из `meeting_notes.txt` (текст), `transcript.txt` (текст) и `recording.mp3` (аудио).
*   Плагин будет создавать Markdown-файлы и сохранять аудиофайлы.
*   Настройки плагина будут сохраняться в файлах данных Obsidian.

## 4. Моделирование системы (При необходимости)
*   Диаграммы последовательности для процесса импорта.
*   Структура данных для настроек плагина.

## 5. Глоссарий
(См. раздел 1.3)

